"use strict";((typeof self<"u"?self:this).webpackChunkMyLibrary=(typeof self<"u"?self:this).webpackChunkMyLibrary||[]).push([[8831],{84551:function(F,u,t){t.r(u)},95387:function(F,u,t){var d=t(38600);Object.defineProperty(u,"__esModule",{value:!0}),u.deleteFiles=void 0;var e=d(t(16906)),g=function(y){return e.default.post("api/v1/file/delete_files/",{files:y})};u.deleteFiles=g},43092:function(F,u,t){Object.defineProperty(u,"__esModule",{value:!0}),u.default=void 0;var d=t(70748),e=t(22247),g=e.Collapse.CollapsePanel,f=(0,d.defineComponent)({name:"PropsCollapsePanel",props:{modelValue:{type:Boolean,default:!1},content:{type:String||Object},title:{type:String||Object},suffix:{type:String||Object}},emits:["update:modelValue","change","ensure","clear"],setup(y,h){var c=h.slots,r=(0,d.ref)(!0);return function(){return(0,d.createVNode)(g,{modelValue:r.value,"onUpdate:modelValue":function(p){return r.value=p}},{header:function(){return(0,d.createVNode)("div",{class:"bk-collapse-header"},[(0,d.createVNode)("i",{class:"bkvision-icon mr-normal ".concat(r.value?"icon-angle-up-fill-3":"icon-angle-right-fill")},null),y.title,y.suffix])},content:function(){return c?.default()}})}}});u.default=f},21503:function(F,u,t){var d=t(38600);Object.defineProperty(u,"__esModule",{value:!0}),u.default=void 0,t(58146);var e=t(70748),g=t(22247);t(84551);var f=d(t(6533)),y=(0,e.defineComponent)({name:"MappingValues",props:{modelValue:{type:Array,default:function(){return[]},required:!0},type:{type:Array,default:function(){return[]}}},emits:["change","update:modelValue"],setup(h,c){var r=c.emit,N=(0,e.ref)(!1),p=(0,e.ref)(h.modelValue);function s(){r("update:modelValue",p.value),r("change",p.value)}return{isShow:N,formData:p,change:s}},render(){var h=this;function c(r){return r.iconsType?r.iconsType==="img"?(0,e.createVNode)("img",{src:r.icon,height:"16",width:"16"},null):r.iconsType==="icon"?(0,e.createVNode)("i",{class:r.icon},null):"":""}return(0,e.createVNode)("div",null,[(0,e.createVNode)("div",null,[this.formData.map(function(r,N){return(0,e.createVNode)("div",{key:N,class:"flex-row align-items-center mapping-value-result"},[(0,e.createVNode)("div",{class:"flex-1 text-ov"},[r.type==="range"?r.range.join("-"):r.value]),(0,e.createVNode)("div",{class:"ml-small mr-small text-gray"},[(0,e.createVNode)("i",{class:"bkvision-icon icon-arrows--right--line"},null)]),(0,e.createVNode)("div",{class:"flex-1 text-ov"},[r.text]),(0,e.createVNode)("div",{style:"background:".concat(r.color,";width:16px;height:16px;border-radius:16px;")},null),(0,e.createVNode)("div",{class:"text-center",style:"width:36px;"},[c(r)])])}),(0,e.createVNode)("div",{class:"text-center mt-normal"},[(0,e.createVNode)(g.Button,{onClick:function(){return h.isShow=!0},class:"full-width",size:"small",outline:!0,theme:"primary"},{default:function(){return[(0,e.createTextVNode)("\u7F16\u8F91\u9608\u503C\u6620\u5C04")]}})])]),this.isShow?(0,e.createVNode)(f.default,{modelValue:h.formData,"onUpdate:modelValue":function(N){return h.formData=N},onChange:this.change,onClose:function(){return h.isShow=!1}},null):""])}});u.default=y},6533:function(F,u,t){var d=t(38600);Object.defineProperty(u,"__esModule",{value:!0}),u.default=void 0;var e=t(70748),g=d(t(64375));t(35340),t(37209),t(58146),t(81821),t(6504),t(4064);var f=t(22247);t(84551);var y=d(t(78310)),h=d(t(19291)),c=t(4980);function r(s){return typeof s=="function"||Object.prototype.toString.call(s)==="[object Object]"&&!(0,e.isVNode)(s)}var N=f.Select.Option,p=(0,e.defineComponent)({name:"MappingValuesEditor",props:{modelValue:{type:Array,default:function(){return[new c.MappingValueClass]},required:!0},type:{type:Array,default:function(){return[]}}},emits:["change","update:modelValue","close"],setup(s,M){var v=M.emit,n=(0,e.ref)(!0),o=(0,e.ref)(s.modelValue||[new c.MappingValueClass]);o.value.length||o.value.push(new c.MappingValueClass);function a(m){o.value.splice(m+1,0,new c.MappingValueClass)}function l(m){o.value.splice(m,1)}function i(){var m="";if(o.value.some(function(b,x){if(!b.text)return m="\u7B2C".concat(x,"\u884C,\u6620\u5C04\u503C\u672A\u586B\u5199"),!0;if(b.type==="range"){var D=(0,g.default)(b.range,2),T=D[0],S=D[1];if(typeof T!="number"||typeof S!="number")return m="\u7B2C".concat(x,"\u884C,\u6620\u5C04\u8303\u56F4\u672A\u586B\u5199"),!0;if(T>=S)return m="\u7B2C".concat(x,"\u884C,\u6620\u5C04\u8303\u56F4\u524D\u503C\u5927\u4E8E\u540E\u503C"),!0}else if(b.type!=="special"&&b.value===null)return!0;return!1})){(0,f.Message)({theme:"error",message:m||"\u8BF7\u5B8C\u5584\u8868\u683C,\u5982\u5FC5\u586B\u9879\u662F\u5426\u586B\u5199\uFF01"});return}v("update:modelValue",o.value),v("change",o.value),C()}function C(){n.value=!1,v("close")}function V(m,b){m.value=null}return{isShow:n,formData:o,changeType:V,add:a,save:i,close:C,remove:l}},render(){var s=this;function M(n){var o;switch(n.type){case"range":return(0,e.createVNode)("div",{class:"flex-row align-items-center"},[(0,e.createVNode)(f.Input,{modelValue:n.range[0],"onUpdate:modelValue":function(l){return n.range[0]=l},size:"small",class:"flex-1",type:"number"},null),(0,e.createVNode)("span",{class:"ml-min mr-min"},[(0,e.createTextVNode)("-")]),(0,e.createVNode)(f.Input,{modelValue:n.range[1],"onUpdate:modelValue":function(l){return n.range[1]=l},size:"small",class:"flex-1",type:"number"},null)]);case"special":return(0,e.createVNode)(f.Select,{modelValue:n.value,"onUpdate:modelValue":function(l){return n.value=l},clearable:!1,size:"small",popoverMinWidth:150},r(o=c.SpecialMatchOptions.map(function(a,l){return(0,e.createVNode)(N,{key:l,label:a.label,value:a.value},{default:function(){return[(0,e.withDirectives)((0,e.createVNode)("div",{class:"flex-row align-items-center justify-content-between"},[(0,e.createVNode)("span",null,[a.label]),(0,e.createVNode)("span",{style:"font-size:.8em;"},[String(a.value)])]),[[(0,e.resolveDirective)("bkTooltips"),{content:a.description}]])]}})}))?o:{default:function(){return[o]}});case"value":return(0,e.createVNode)(f.Input,{type:"number",modelValue:n.value,"onUpdate:modelValue":function(l){return n.value=l},size:"small"},null);default:return(0,e.createVNode)(f.Input,{modelValue:n.value,"onUpdate:modelValue":function(l){return n.value=l},size:"small"},null)}}function v(n){return n.iconsType?n.iconsType==="img"?(0,e.createVNode)(f.Input,{modelValue:n.src,"onUpdate:modelValue":function(a){return n.src=a},size:"small"},null):n.iconsType==="icon"?(0,e.createVNode)(f.Select,{modelValue:n.icon,"onUpdate:modelValue":function(a){return n.icon=a},size:"small",popoverMinWidth:120},{prefix:function(){return n.icon?(0,e.createVNode)("i",{class:"".concat(n.icon," pl-small"),style:"line-height:24px;"},null):null},default:function(){return(0,e.createVNode)(e.Fragment,null,[(0,e.createVNode)(N,{label:"\u4E0A\u5347",value:"bkvision-icon icon-shangsheng"},{default:function(){return[(0,e.createVNode)("div",{class:"flex-row align-items-center justify-content-between"},[(0,e.createVNode)("span",null,[(0,e.createVNode)("i",{class:"bkvision-icon icon-shangsheng"},null)]),(0,e.createVNode)("span",{style:"font-size:.8em;"},[(0,e.createTextVNode)("\u4E0A\u5347")])])]}}),(0,e.createVNode)(N,{label:"\u4E0B\u964D",value:"bkvision-icon icon-xiajiang"},{default:function(){return[(0,e.createVNode)("div",{class:"flex-row align-items-center justify-content-between"},[(0,e.createVNode)("span",null,[(0,e.createVNode)("i",{class:"bkvision-icon icon-xiajiang"},null)]),(0,e.createVNode)("span",{style:"font-size:.8em;"},[(0,e.createTextVNode)("\u4E0B\u964D")])])]}}),(0,e.createVNode)(N,{label:"\u544A\u8B66",value:"bkvision-icon icon-gaojingxinxi"},{default:function(){return[(0,e.createVNode)("div",{class:"flex-row align-items-center justify-content-between"},[(0,e.createVNode)("span",null,[(0,e.createVNode)("i",{class:"bkvision-icon icon-gaojingxinxi"},null)]),(0,e.createVNode)("span",{style:"font-size:.8em;"},[(0,e.createTextVNode)("\u544A\u8B66")])])]}})])}}):"":""}return(0,e.createVNode)(f.Dialog,{"is-show":s.isShow,"onUpdate:is-show":function(o){return s.isShow=o},width:1e3,title:"\u9608\u503C\u6620\u5C04",closeIcon:this.isShow,onClosed:this.close,escClose:!1,quickClose:!1},{default:function(){return(0,e.createVNode)("div",{class:"mapping-value-body"},[(0,e.createVNode)("table",{class:"bv-table-box bv-table-row-border",cellpadding:"0",cellspacing:"0"},[(0,e.createVNode)("thead",null,[(0,e.createVNode)("tr",{class:"bv-common-title"},[(0,e.createVNode)("th",{width:"30"},null),(0,e.createVNode)("th",{width:"100"},[(0,e.createTextVNode)("\u7C7B\u578B")]),(0,e.createVNode)("th",null,[(0,e.createVNode)("span",null,[(0,e.createTextVNode)("\u6620\u5C04\u6761\u4EF6")]),(0,e.createVNode)("span",{class:"text-danger ml-min"},[(0,e.createTextVNode)("*")])]),(0,e.withDirectives)((0,e.createVNode)("th",null,[(0,e.createVNode)("span",{class:"align-items-center text-decoration-dashed",style:"display: inline-block;"},[(0,e.createTextVNode)("\u6620\u5C04\u503C")]),(0,e.createVNode)("span",{class:"text-danger ml-min"},[(0,e.createTextVNode)("*")])]),[[(0,e.resolveDirective)("bkTooltips"),{content:"".concat(c.originalMapValue,'\u4E3A\u539F\u59CB\u503C\u6A21\u677F\u66FF\u6362,\u5982 100 \u66FF\u6362 "\u5371\uFF1A').concat(c.originalMapValue,'\uFF01"\uFF0C\u66FF\u6362\u7ED3\u679C\u4E3A\uFF1A"\u5371\uFF1A100\uFF01"\uFF08\u6B63\u5219\u4E3A\u5168\u6587\u672C\u66FF\u6362\uFF0C\u4E0D\u9002\u5408\u6B64\u89C4\u5219\uFF09')}]]),(0,e.createVNode)("th",{width:"150"},[(0,e.createTextVNode)("\u989C\u8272")]),(0,e.createVNode)("th",{width:"100"},[(0,e.createTextVNode)("\u6807\u5FD7\u7C7B\u578B")]),(0,e.createVNode)("th",{width:"120"},[(0,e.createTextVNode)("\u6807\u5FD7")]),(0,e.createVNode)("th",{width:"80"},null)])]),(0,e.createVNode)(h.default,{list:s.formData,handle:".dragging-handle",tag:"tbody","item-key":"uid",class:"bg-white"},{item:function(a){var l,i=a.element,C=a.index;return(0,e.createVNode)("tr",{key:C},[(0,e.createVNode)("td",{class:"dragging-handle text-center"},[(0,e.createVNode)("i",{class:"bkvision-icon icon-ketuodong"},null)]),(0,e.createVNode)("td",null,[(0,e.createVNode)(f.Select,{onChange:function(m){return s.changeType(i,m)},modelValue:i.type,"onUpdate:modelValue":function(m){return i.type=m},clearable:!1,size:"small",popoverMinWidth:150},r(l=c.MappingValueTypeOptions.map(function(V){return(0,e.createVNode)(N,{key:V.value,label:V.label,value:V.value},{default:function(){return[(0,e.createVNode)("div",{class:"flex-row align-items-center justify-content-between"},[(0,e.createVNode)("span",null,[V.label]),(0,e.createVNode)("span",{style:"font-size:.8em;"},[V.value])])]}})}))?l:{default:function(){return[l]}})]),(0,e.createVNode)("td",null,[M(i)]),(0,e.createVNode)("td",null,[(0,e.createVNode)(f.Input,{modelValue:i.text,"onUpdate:modelValue":function(m){return i.text=m},size:"small"},null)]),(0,e.createVNode)("td",null,[(0,e.createVNode)(f.ColorPicker,{modelValue:i.color,"onUpdate:modelValue":function(m){return i.color=m},transfer:!0,style:"width:120px;",size:"small"},null)]),(0,e.createVNode)("td",null,[(0,e.createVNode)(f.Select,{modelValue:i.iconsType,"onUpdate:modelValue":function(m){return i.iconsType=m},list:c.MappingSymbolOptions,size:"small",clearable:!1},null)]),(0,e.createVNode)("td",null,[v(i)]),(0,e.createVNode)("td",{class:"font-medium bv-td-operation"},[(0,e.createVNode)("i",{onClick:function(){return s.add(C)},class:"bkvision-icon icon-plus cursor-pointer mr-normal"},null),(0,e.createVNode)("i",{onClick:function(){return s.remove(C)},class:(0,y.default)("bkvision-icon icon-subtract cursor-pointer",{"disabled-text point-event-none":s.formData.length<2})},null)])])}})])])},footer:function(){return(0,e.createVNode)("div",{class:"operation flex-row align-items-center"},[(0,e.createVNode)(f.Button,{theme:"primary",onClick:s.save},{default:function(){return[(0,e.createTextVNode)("\u4FDD\u5B58")]}}),(0,e.createVNode)(f.Button,{onClick:s.close},{default:function(){return[(0,e.createTextVNode)("\u53D6\u6D88")]}})])}})}});u.default=p},32125:function(F,u,t){var d=t(38600);Object.defineProperty(u,"__esModule",{value:!0}),u.default=void 0;var e=t(70748);t(9100),t(59751);var g=t(72993),f=t(2769),y=d(t(56990)),h=t(22247),c=d(t(43092)),r=d(t(21503)),N=(0,e.defineComponent)({name:"RichTextPropPanel",props:{panelModel:{type:Object,required:!0}},emits:["change","update:panelModel"],setup(p,s){var M=s.emit,v=(0,g.useRoute)(),n=v.params.space_uid,o=(0,e.ref)(!p.panelModel.chartConfig.content),a=(0,e.ref)(p.panelModel.chartConfig),l={cover:!1,usage:"richtext",space_uid:n},i=(0,f.throttle)(function(C){var V=p.panelModel;Object.assign(V,{chartConfig:C}),M("update:panelModel",V),M("change",V)},1e3);return(0,e.watch)(a,function(C){i(C)},{deep:!0}),{formData:a,meta:l,isSave:o}},render(){var p=this;return(0,e.createVNode)("div",{class:"props-panel full-height flex-column"},[(0,e.createVNode)("div",{class:"chart-info"},[(0,e.createVNode)(c.default,{title:"\u9608\u503C\u6620\u5C04",suffix:(0,e.createVNode)(h.Switcher,{theme:"primary",modelValue:p.formData.mapping.isShow,"onUpdate:modelValue":function(M){return p.formData.mapping.isShow=M},size:"small",class:"ml-min"},null)},{default:function(){return[p.formData.mapping.isShow?(0,e.createVNode)(r.default,{modelValue:p.formData.mapping.list,"onUpdate:modelValue":function(v){return p.formData.mapping.list=v}},null):"",(0,e.createVNode)("div",{class:"mt-normal"},null),(0,e.createVNode)(h.Alert,{theme:"info",title:"\u4F7F\u7528\u8BED\u6CD5\uFF1A {{A.0.key}} \u5C06\u76F4\u63A5\u66FF\u6362sql\u67E5\u8BE2\u7ED3\u679C\uFF0C\u4F7F\u7528 {{##A.0.key##}} \u5C06\u5339\u914D\u9608\u503C\u66FF\u6362 "},null)]}})]),(0,e.createVNode)(h.Divider,null,null),(0,e.createVNode)(y.default,{modelValue:p.formData.content,"onUpdate:modelValue":function(M){return p.formData.content=M},meta:this.meta},null)])}});u.default=N},56990:function(F,u,t){Object.defineProperty(u,"__esModule",{value:!0}),u.default=void 0;var d=t(70748);t(34),t(37209),t(58146),t(4064),t(99057),t(14827),t(59751);var e=t(67104),g=t(95387),f=(0,d.defineComponent)({name:"RichTextEditor",props:{modelValue:{type:String,required:!0,default:""},server:{type:String,default:"/api/v1/file/upload/"},meta:{type:Object,default:null}},emits:["update:modelValue"],setup(y,h){var c=h.emit,r=(0,d.shallowRef)(null),N=(0,d.computed)({get:function(){return y.modelValue},set:function(l){return c("update:modelValue",l)}}),p=[],s=[];function M(){var a=r.value.getElemsByType("image").map(function(i){var C=i.src;return C}).filter(function(i){return i}),l=[].concat(p.filter(function(i){return!a.includes(i)}),s.filter(function(i){return!a.includes(i)}));l.length&&(0,g.deleteFiles)(l)}var v={},n={placeholder:"\u8BF7\u8F93\u5165\u5185\u5BB9...",MENU_CONF:{uploadImage:{server:y.server,fieldName:"instance",maxFileSize:1024*1024*5,maxNumberOfFiles:50,allowedFileTypes:["image/*"],meta:y.meta,metaWithUrl:!1,customInsert(a,l){l(a.data.instance,"","")},withCredentials:!0,timeout:5*1e3,onSuccess(a,l){console.log("".concat(a.name," \u4E0A\u4F20\u6210\u529F"),l)},onFailed(a,l){console.log("".concat(a.name," \u4E0A\u4F20\u5931\u8D25"),l)},onError(a,l,i){console.log("".concat(a.name," \u4E0A\u4F20\u51FA\u9519"),l,i)}},insertImage:{onInsertedImage:function(l){l!==null&&p.push(l.src)}}},hoverbarKeys:{formula:{menuKeys:["editFormula"]}}};(0,d.onBeforeUnmount)(function(){M();var a=r.value;a!==null&&a.destroy()});var o=function(l){r.value=l,s=l.getElemsByType("image").map(function(i){var C=i.src;return C}).filter(function(i){return i})};return{editorRef:r,formData:N,toolbarConfig:v,editorConfig:n,handleCreated:o}},render(){var y=this;return(0,d.createVNode)("div",{class:"props-panel full-height flex-column"},[(0,d.createVNode)(e.Toolbar,{style:"border-bottom: 1px solid #ccc",editor:this.editorRef,defaultConfig:this.toolbarConfig},null),(0,d.createVNode)(e.Editor,{style:"height: 500px; overflow-y: hidden;",modelValue:y.formData,"onUpdate:modelValue":function(c){return y.formData=c},defaultConfig:this.editorConfig,onOnCreated:this.handleCreated},null)])}});u.default=f},4980:function(F,u,t){var d=t(38600);Object.defineProperty(u,"__esModule",{value:!0}),u.originalMapValue=u.SpecialMatchOptions=u.MappingValueTypeOptions=u.MappingValueClass=u.MappingSymbolOptions=void 0,u.replaceMappingValue=M,u.replaceValue=p,t(99057),t(14827),t(3105),t(19341),t(33071),t(25181),t(4064);var e=d(t(64375)),g=d(t(63638)),f=d(t(5271)),y=[{label:"\u503C",value:"value"},{label:"\u8303\u56F4",value:"range"},{label:"\u6587\u672C",value:"text"},{label:"\u6B63\u5219",value:"regex"},{label:"\u7279\u6B8A\u503C",value:"special"}];u.MappingValueTypeOptions=y;var h=[{label:"\u65E0",value:""},{label:"\u56FE\u6807",value:"icon"},{label:"\u56FE\u7247",value:"img"}];u.MappingSymbolOptions=h;var c="{{$value}}";u.originalMapValue=c;class r{constructor(){(0,g.default)(this,"type","value"),(0,g.default)(this,"text",c),(0,g.default)(this,"value",null),(0,g.default)(this,"range",[null,null]),(0,g.default)(this,"color",""),(0,g.default)(this,"icon",""),(0,g.default)(this,"iconsType",""),(0,g.default)(this,"src",void 0),(0,g.default)(this,"uid",void 0),this.uid=(0,f.default)()}}u.MappingValueClass=r;var N=[{label:"Null",value:null,description:"Matches null and undefined values"},{label:"NaN",value:"NaN",description:"Matches against Number.NaN (not a number)"},{label:"True",value:!0,description:"Boolean true values"},{label:"False",value:!1,description:"Boolean false values"},{label:"\u7A7A\u5B57\u7B26\u4E32",value:"",description:"Empty string"}];u.SpecialMatchOptions=N;function p(v,n){return n===c?n:n.includes(c)?n.replace(c,String(v)):n}function s(v,n,o){switch(v){case"icon":return n?'<i class="'.concat(n,'"></i>'):"";case"img":return o?'<img src="'.concat(o,'" height="16" width="16"/>'):"";default:return""}}function M(v,n){if(!v||!(n!=null&&n.length))return v;for(var o=v,a=n.length-1;a>=0;a--){var l=n[a],i=l.type,C=l.value,V=l.text,m=l.range,b=l.iconsType,x=l.icon,D=l.color,T=l.src,S=s(b,x,T),U=!1;switch(i){case"value":case"special":case"text":C===v&&(U=!0,o=p(v,V));break;case"range":{var O=(0,e.default)(m,2),j=O[0],E=O[1];E>j&&E>o&&j<o&&(U=!0,o=p(T,V))}break;case"regex":{var A=String(v);new RegExp(String(C),"g").test(A)&&(U=!0,o=A.replace(new RegExp(String(C),"g"),V))}break}if(U){o='<span style="color: '.concat(D,'">').concat(o).concat(S,"</span>");break}}return o}}}]);
