((typeof self<"u"?self:this).webpackChunkMyLibrary=(typeof self<"u"?self:this).webpackChunkMyLibrary||[]).push([[4672],{99986:function(Q,o,t){"use strict";t.r(o)},31775:function(Q,o,t){"use strict";t.r(o)},30338:function(Q,o,t){var p=t(41072),n=t(88057),C=t(60687),c=t(15701),s=TypeError,v=function(g){return function(N,S,M,L){p(S);var O=n(N),f=C(O),u=c(O),m=g?u-1:0,j=g?-1:1;if(M<2)for(;;){if(m in f){L=f[m],m+=j;break}if(m+=j,g?m<0:u<=m)throw s("Reduce of empty array with no initial value")}for(;g?m>=0:u>m;m+=j)m in f&&(L=S(L,f[m],m,O));return L}};Q.exports={left:v(!1),right:v(!0)}},50424:function(Q,o,t){var p=t(64289);Q.exports=p(1 .valueOf)},97870:function(Q,o,t){"use strict";var p=t(95610),n=t(30338).left,C=t(76614),c=t(21128),s=t(91618),v=C("reduce"),g=!s&&c>79&&c<83;p({target:"Array",proto:!0,forced:!v||g},{reduce:function(S){var M=arguments.length;return n(this,S,M,M>1?arguments[1]:void 0)}})},88322:function(Q,o,t){"use strict";var p=t(77246),n=t(85985),C=t(64289),c=t(73289),s=t(25847),v=t(93245),g=t(52575),N=t(71243),S=t(64052),M=t(35650),L=t(17210),O=t(70056).f,f=t(90948).f,u=t(956).f,m=t(50424),j=t(97942).trim,F="Number",w=n[F],P=w.prototype,I=n.TypeError,U=C("".slice),k=C("".charCodeAt),H=function(e){var a=M(e,"number");return typeof a=="bigint"?a:z(a)},z=function(e){var a=M(e,"number"),r,i,d,b,V,T,h,E;if(S(a))throw I("Cannot convert a Symbol value to a number");if(typeof a=="string"&&a.length>2){if(a=j(a),r=k(a,0),r===43||r===45){if(i=k(a,2),i===88||i===120)return NaN}else if(r===48){switch(k(a,1)){case 66:case 98:d=2,b=49;break;case 79:case 111:d=8,b=55;break;default:return+a}for(V=U(a,2),T=V.length,h=0;h<T;h++)if(E=k(V,h),E<48||E>b)return NaN;return parseInt(V,d)}}return+a};if(c(F,!w(" 0o1")||!w("0b1")||w("+0x1"))){for(var R=function(a){var r=arguments.length<1?0:w(H(a)),i=this;return N(P,i)&&L(function(){m(i)})?g(Object(r),i,R):r},_=p?O(w):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,isFinite,isInteger,isNaN,isSafeInteger,parseFloat,parseInt,fromString,range".split(","),y=0,l;_.length>y;y++)v(w,l=_[y])&&!v(R,l)&&u(R,l,f(w,l));R.prototype=P,P.constructor=R,s(n,F,R,{constructor:!0})}},35385:function(Q,o,t){"use strict";t.r(o),t.d(o,{__assign:function(){return C},__asyncDelegator:function(){return P},__asyncGenerator:function(){return w},__asyncValues:function(){return I},__await:function(){return F},__awaiter:function(){return N},__classPrivateFieldGet:function(){return R},__classPrivateFieldIn:function(){return y},__classPrivateFieldSet:function(){return _},__createBinding:function(){return M},__decorate:function(){return s},__exportStar:function(){return L},__extends:function(){return n},__generator:function(){return S},__importDefault:function(){return z},__importStar:function(){return H},__makeTemplateObject:function(){return U},__metadata:function(){return g},__param:function(){return v},__read:function(){return f},__rest:function(){return c},__spread:function(){return u},__spreadArray:function(){return j},__spreadArrays:function(){return m},__values:function(){return O}});var p=function(l,e){return p=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,r){a.__proto__=r}||function(a,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(a[i]=r[i])},p(l,e)};function n(l,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");p(l,e);function a(){this.constructor=l}l.prototype=e===null?Object.create(e):(a.prototype=e.prototype,new a)}var C=function(){return C=Object.assign||function(e){for(var a,r=1,i=arguments.length;r<i;r++){a=arguments[r];for(var d in a)Object.prototype.hasOwnProperty.call(a,d)&&(e[d]=a[d])}return e},C.apply(this,arguments)};function c(l,e){var a={};for(var r in l)Object.prototype.hasOwnProperty.call(l,r)&&e.indexOf(r)<0&&(a[r]=l[r]);if(l!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(l);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(l,r[i])&&(a[r[i]]=l[r[i]]);return a}function s(l,e,a,r){var i=arguments.length,d=i<3?e:r===null?r=Object.getOwnPropertyDescriptor(e,a):r,b;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(l,e,a,r);else for(var V=l.length-1;V>=0;V--)(b=l[V])&&(d=(i<3?b(d):i>3?b(e,a,d):b(e,a))||d);return i>3&&d&&Object.defineProperty(e,a,d),d}function v(l,e){return function(a,r){e(a,r,l)}}function g(l,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(l,e)}function N(l,e,a,r){function i(d){return d instanceof a?d:new a(function(b){b(d)})}return new(a||(a=Promise))(function(d,b){function V(E){try{h(r.next(E))}catch(B){b(B)}}function T(E){try{h(r.throw(E))}catch(B){b(B)}}function h(E){E.done?d(E.value):i(E.value).then(V,T)}h((r=r.apply(l,e||[])).next())})}function S(l,e){var a={label:0,sent:function(){if(d[0]&1)throw d[1];return d[1]},trys:[],ops:[]},r,i,d,b;return b={next:V(0),throw:V(1),return:V(2)},typeof Symbol=="function"&&(b[Symbol.iterator]=function(){return this}),b;function V(h){return function(E){return T([h,E])}}function T(h){if(r)throw new TypeError("Generator is already executing.");for(;b&&(b=0,h[0]&&(a=0)),a;)try{if(r=1,i&&(d=h[0]&2?i.return:h[0]?i.throw||((d=i.return)&&d.call(i),0):i.next)&&!(d=d.call(i,h[1])).done)return d;switch(i=0,d&&(h=[h[0]&2,d.value]),h[0]){case 0:case 1:d=h;break;case 4:return a.label++,{value:h[1],done:!1};case 5:a.label++,i=h[1],h=[0];continue;case 7:h=a.ops.pop(),a.trys.pop();continue;default:if(d=a.trys,!(d=d.length>0&&d[d.length-1])&&(h[0]===6||h[0]===2)){a=0;continue}if(h[0]===3&&(!d||h[1]>d[0]&&h[1]<d[3])){a.label=h[1];break}if(h[0]===6&&a.label<d[1]){a.label=d[1],d=h;break}if(d&&a.label<d[2]){a.label=d[2],a.ops.push(h);break}d[2]&&a.ops.pop(),a.trys.pop();continue}h=e.call(l,a)}catch(E){h=[6,E],i=0}finally{r=d=0}if(h[0]&5)throw h[1];return{value:h[0]?h[1]:void 0,done:!0}}}var M=Object.create?function(l,e,a,r){r===void 0&&(r=a);var i=Object.getOwnPropertyDescriptor(e,a);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[a]}}),Object.defineProperty(l,r,i)}:function(l,e,a,r){r===void 0&&(r=a),l[r]=e[a]};function L(l,e){for(var a in l)a!=="default"&&!Object.prototype.hasOwnProperty.call(e,a)&&M(e,l,a)}function O(l){var e=typeof Symbol=="function"&&Symbol.iterator,a=e&&l[e],r=0;if(a)return a.call(l);if(l&&typeof l.length=="number")return{next:function(){return l&&r>=l.length&&(l=void 0),{value:l&&l[r++],done:!l}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function f(l,e){var a=typeof Symbol=="function"&&l[Symbol.iterator];if(!a)return l;var r=a.call(l),i,d=[],b;try{for(;(e===void 0||e-- >0)&&!(i=r.next()).done;)d.push(i.value)}catch(V){b={error:V}}finally{try{i&&!i.done&&(a=r.return)&&a.call(r)}finally{if(b)throw b.error}}return d}function u(){for(var l=[],e=0;e<arguments.length;e++)l=l.concat(f(arguments[e]));return l}function m(){for(var l=0,e=0,a=arguments.length;e<a;e++)l+=arguments[e].length;for(var r=Array(l),i=0,e=0;e<a;e++)for(var d=arguments[e],b=0,V=d.length;b<V;b++,i++)r[i]=d[b];return r}function j(l,e,a){if(a||arguments.length===2)for(var r=0,i=e.length,d;r<i;r++)(d||!(r in e))&&(d||(d=Array.prototype.slice.call(e,0,r)),d[r]=e[r]);return l.concat(d||Array.prototype.slice.call(e))}function F(l){return this instanceof F?(this.v=l,this):new F(l)}function w(l,e,a){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=a.apply(l,e||[]),i,d=[];return i={},b("next"),b("throw"),b("return"),i[Symbol.asyncIterator]=function(){return this},i;function b(A){r[A]&&(i[A]=function($){return new Promise(function(D,G){d.push([A,$,D,G])>1||V(A,$)})})}function V(A,$){try{T(r[A]($))}catch(D){B(d[0][3],D)}}function T(A){A.value instanceof F?Promise.resolve(A.value.v).then(h,E):B(d[0][2],A)}function h(A){V("next",A)}function E(A){V("throw",A)}function B(A,$){A($),d.shift(),d.length&&V(d[0][0],d[0][1])}}function P(l){var e,a;return e={},r("next"),r("throw",function(i){throw i}),r("return"),e[Symbol.iterator]=function(){return this},e;function r(i,d){e[i]=l[i]?function(b){return(a=!a)?{value:F(l[i](b)),done:i==="return"}:d?d(b):b}:d}}function I(l){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=l[Symbol.asyncIterator],a;return e?e.call(l):(l=typeof O=="function"?O(l):l[Symbol.iterator](),a={},r("next"),r("throw"),r("return"),a[Symbol.asyncIterator]=function(){return this},a);function r(d){a[d]=l[d]&&function(b){return new Promise(function(V,T){b=l[d](b),i(V,T,b.done,b.value)})}}function i(d,b,V,T){Promise.resolve(T).then(function(h){d({value:h,done:V})},b)}}function U(l,e){return Object.defineProperty?Object.defineProperty(l,"raw",{value:e}):l.raw=e,l}var k=Object.create?function(l,e){Object.defineProperty(l,"default",{enumerable:!0,value:e})}:function(l,e){l.default=e};function H(l){if(l&&l.__esModule)return l;var e={};if(l!=null)for(var a in l)a!=="default"&&Object.prototype.hasOwnProperty.call(l,a)&&M(e,l,a);return k(e,l),e}function z(l){return l&&l.__esModule?l:{default:l}}function R(l,e,a,r){if(a==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?l!==e||!r:!e.has(l))throw new TypeError("Cannot read private member from an object whose class did not declare it");return a==="m"?r:a==="a"?r.call(l):r?r.value:e.get(l)}function _(l,e,a,r,i){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?l!==e||!i:!e.has(l))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?i.call(l,a):i?i.value=a:e.set(l,a),a}function y(l,e){if(e===null||typeof e!="object"&&typeof e!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof l=="function"?e===l:l.has(e)}},19081:function(Q,o,t){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.Component=o.ComponentBase=void 0;const p=t(70748),n=t(91274),C=t(52376),c=t(16262),s=t(64391),v=t(35185),g=t(93192),N=t(77706),S=t(81965),M=t(49104),L=t(15574),O=t(30283);function f(P,I){const U={};return(0,L.build)(P,U),(0,C.build)(P,U),(0,g.build)(P,U),(0,N.build)(P,U),(0,S.build)(P,U),(0,M.build)(P,U),(0,v.build)(P,U),(0,s.build)(P,U),(0,O.build)(P,U),Object.assign(Object.assign({data(){var H;const z={};return(0,c.build)(P,z),(H=z.data)!==null&&H!==void 0?H:{}},methods:U.methods,computed:U.computed,watch:U.watch,props:U.props,inject:U.inject},U.hooks),{extends:I})}function u(P,I,U){let k=f(P,U);const H=(0,n.obtainSlot)(P.prototype);Object.keys(I).reduce((R,_)=>(["options","modifier","emits"].includes(_)||(R[_]=I[_]),R),k);let z=Array.from(H.obtainMap("emits").keys());return Array.isArray(I.emits)&&(z=Array.from(new Set([...z,...I.emits]))),k.emits=z,I.options&&Object.assign(k,I.options),I.modifier&&I.modifier(k),(0,p.defineComponent)(k)}function m(P,I){const U=(0,n.obtainSlot)(P.prototype);U.inComponent=!0;const k=(0,n.getSuperSlot)(P.prototype);if(k){if(!k.inComponent)throw"Class should be decorated by Component or ComponentBase: "+U.master;if(k.cachedVueComponent===null)throw"Component decorator 1"}const H=u(P,I,k===null?void 0:k.cachedVueComponent);H.__vfdConstructor=P,U.cachedVueComponent=H}function j(P,I){return typeof P=="function"?I(P,{}):function(U){return I(U,P)}}function F(P){return j(P,function(I,U){return m(I,U),I})}o.ComponentBase=F;function w(P){return j(P,function(I,U){return m(I,U),(0,n.obtainSlot)(I.prototype).cachedVueComponent})}o.Component=w},64210:function(Q,o,t){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.Vue=o.Base=o.TSX=o.Hook=o.Vanilla=o.Model=o.VModel=o.Emit=o.Inject=o.Prop=o.Watch=o.Ref=o.ComponentBase=o.Component=void 0;var p=t(19081);Object.defineProperty(o,"Component",{enumerable:!0,get:function(){return p.Component}}),Object.defineProperty(o,"ComponentBase",{enumerable:!0,get:function(){return p.ComponentBase}});var n=t(35185);Object.defineProperty(o,"Ref",{enumerable:!0,get:function(){return n.decorator}});var C=t(93192);Object.defineProperty(o,"Watch",{enumerable:!0,get:function(){return C.decorator}});var c=t(77706);Object.defineProperty(o,"Prop",{enumerable:!0,get:function(){return c.decorator}});var s=t(81965);Object.defineProperty(o,"Inject",{enumerable:!0,get:function(){return s.decorator}});var v=t(49104);Object.defineProperty(o,"Emit",{enumerable:!0,get:function(){return v.decorator}});var g=t(15574);Object.defineProperty(o,"VModel",{enumerable:!0,get:function(){return g.decorator}}),Object.defineProperty(o,"Model",{enumerable:!0,get:function(){return g.decorator}});var N=t(92360);Object.defineProperty(o,"Vanilla",{enumerable:!0,get:function(){return N.decorator}});var S=t(64391);Object.defineProperty(o,"Hook",{enumerable:!0,get:function(){return S.decorator}});const M=Symbol("vue-facing-decorator-identify");function L(){return function(O){return O}}o.TSX=L,o.Base=class{},o.Vue=o.Base},30283:function(Q,o,t){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.build=void 0;const p=t(41886),n=t(91274);function C(c,s){let g=(0,n.obtainSlot)(c.prototype).obtainMap("vanilla");const N=(0,n.toComponentReverse)(c.prototype),S=new Map;(0,p.applyAccessors)(s,M=>(N.forEach(L=>{const O=Object.getOwnPropertyDescriptors(L);for(const f in O){const u=O[f];u&&g.has(f)&&(typeof u.get=="function"||typeof u.set=="function")&&S.set(f,{set:typeof u.set=="function"?u.set.bind(M):void 0,get:typeof u.get=="function"?u.get.bind(M):void 0})}}),S))}o.build=C},52376:function(Q,o,t){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.build=void 0;const p=t(91274);function n(C,c){var s;(s=c.computed)!==null&&s!==void 0||(c.computed={});const v=(0,p.obtainSlot)(C.prototype);let g=v.obtainMap("computed"),N=v.obtainMap("vanilla");(0,p.toComponentReverse)(C.prototype).forEach(M=>{(0,p.getValidNames)(M,(L,O)=>(typeof L.get=="function"||typeof L.set=="function")&&!N.has(O)).forEach(L=>{g.set(L,!0);const O=Object.getOwnPropertyDescriptor(M,L);c.computed[L]={get:typeof O.get=="function"?O.get:void 0,set:typeof O.set=="function"?O.set:void 0}})})}o.build=n},16262:function(Q,o,t){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.build=void 0;const p=t(91274),n=t(91274);function C(c,s){var v;(v=s.data)!==null&&v!==void 0||(s.data={});const g=new c;let N=(0,n.getValidNames)(g,M=>!!M.enumerable);const S=(0,n.obtainSlot)(c.prototype);N=(0,n.excludeNames)(N,S),Object.assign(s.data,(0,p.makeObject)(N,g))}o.build=C},49104:function(Q,o,t){"use strict";var p=this&&this.__awaiter||function(c,s,v,g){function N(S){return S instanceof v?S:new v(function(M){M(S)})}return new(v||(v=Promise))(function(S,M){function L(u){try{f(g.next(u))}catch(m){M(m)}}function O(u){try{f(g.throw(u))}catch(m){M(m)}}function f(u){u.done?S(u.value):N(u.value).then(L,O)}f((g=g.apply(c,s||[])).next())})};Object.defineProperty(o,"__esModule",{value:!0}),o.build=o.decorator=void 0;const n=t(91274);o.decorator=(0,n.optoinNullableMemberDecorator)(function(c,s,v){(0,n.obtainSlot)(c).obtainMap("emit").set(s,typeof v>"u"?null:v)});function C(c,s){var v;(v=s.methods)!==null&&v!==void 0||(s.methods={});const g=c.prototype,N=(0,n.obtainSlot)(g),S=N.obtainMap("emit"),M=N.obtainMap("emits");S&&S.forEach((L,O)=>{const f=L===null?O:L;M.set(f,!0),s.methods[O]=function(){return p(this,arguments,void 0,function*(){const u=g[O].apply(this,arguments);if(u instanceof Promise){const m=yield u;this.$emit(f,m)}else this.$emit(f,u)})}})}o.build=C},81965:function(Q,o,t){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.build=o.decorator=void 0;const p=t(91274);o.decorator=(0,p.optoinNullableMemberDecorator)(function(C,c,s){let g=(0,p.obtainSlot)(C).obtainMap("inject");const N=Object.assign({},s??{});g.set(c,N)});function n(C,c){var s;(s=c.inject)!==null&&s!==void 0||(c.inject={});const g=(0,p.obtainSlot)(C.prototype).obtainMap("inject");g&&g.forEach((N,S)=>{c.inject[S]=N})}o.build=n},64391:function(Q,o,t){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.build=o.decorator=o.HookNames=void 0;const p=t(91274);o.HookNames=["beforeCreate","created","beforeMount","mounted","beforeUpdate","updated","activated","deactivated","beforeDestroy","beforeUnmount","destroyed","unmounted","renderTracked","renderTriggered","errorCaptured","serverPrefetch","render"],o.decorator=(0,p.optoinNullableMemberDecorator)(function(C,c){(0,p.obtainSlot)(C).obtainMap("hooks").set(c,null)});function n(C,c){var s,v;const g=(0,p.obtainSlot)(C.prototype),N=(0,p.toComponentReverse)(C.prototype),S=g.obtainMap("hooks");(s=c.hooks)!==null&&s!==void 0||(c.hooks={}),(v=c.methods)!==null&&v!==void 0||(c.methods={});const M={},L={};N.forEach(f=>{(0,p.excludeNames)((0,p.getValidNames)(f,(u,m)=>m==="constructor"?!1:typeof u.value=="function"),g).forEach(u=>{o.HookNames.includes(u)||S.has(u)?M[u]=f[u]:L[u]=f[u]})}),Object.assign(c.methods,L);const O=c.beforeCreateCallbacks;if(O&&O.length>0){const f=M.beforeCreate;M.beforeCreate=function(){O.forEach(u=>u.apply(this,arguments)),f&&f.apply(this,arguments)}}Object.assign(c.hooks,M)}o.build=n},77706:function(Q,o,t){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.build=o.decorator=void 0;const p=t(91274);o.decorator=(0,p.optoinNullableMemberDecorator)(function(C,c,s){let g=(0,p.obtainSlot)(C).obtainMap("props");const N=Object.assign({},s??{});g.set(c,N)});function n(C,c){var s;(s=c.props)!==null&&s!==void 0||(c.props={});const g=(0,p.obtainSlot)(C.prototype).obtainMap("props");g&&g.forEach((N,S)=>{c.props[S]=N})}o.build=n},35185:function(Q,o,t){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.build=o.decorator=void 0;const p=t(41886),n=t(91274);o.decorator=(0,n.optoinNullableMemberDecorator)(function(c,s,v){(0,n.obtainSlot)(c).obtainMap("ref").set(s,!0)});function C(c,s){const g=(0,n.obtainSlot)(c.prototype).obtainMap("ref");g&&(0,p.applyAccessors)(s,N=>{const S=new Map;return g.forEach((M,L)=>{S.set(L,{get:function(){return N.$refs[L]},set:void 0})}),S})}o.build=C},92360:function(Q,o,t){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.decorator=void 0;const p=t(91274);o.decorator=(0,p.optoinNullableMemberDecorator)(function(n,C,c){(0,p.obtainSlot)(n).obtainMap("vanilla").set(C,!0)})},15574:function(Q,o,t){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.build=o.decorator=void 0;const p=t(91274),n=t(77706);o.decorator=(0,p.optoinNullableMemberDecorator)(function(c,s,v){var g;v??(v={});const N=(0,p.obtainSlot)(c);let S="modelValue";const M=Object.assign({},v);M&&(S=(g=M.name)!==null&&g!==void 0?g:S,delete M.name),(0,n.decorator)(M)(c,S),N.obtainMap("v-model").set(s,v)});function C(c,s){var v;(v=s.computed)!==null&&v!==void 0||(s.computed={});const N=(0,p.obtainSlot)(c.prototype).obtainMap("v-model");N&&N.size>0&&N.forEach((S,M)=>{var L;let O=(L=S&&S.name)!==null&&L!==void 0?L:"modelValue";s.computed[M]={get:function(){return this[O]},set:function(f){this.$emit(`update:${O}`,f)}}})}o.build=C},93192:function(Q,o,t){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.build=o.decorator=void 0;const p=t(91274);function n(c,s){return function(v,g){let S=(0,p.obtainSlot)(v).obtainMap("watch");const M=Object.assign({},s??{},{key:c,handler:v[g]});if(S.has(g)){const L=S.get(g);Array.isArray(L)?L.push(M):S.set(g,[L,M])}else S.set(g,M)}}o.decorator=n;function C(c,s){var v;(v=s.watch)!==null&&v!==void 0||(s.watch={});const N=(0,p.obtainSlot)(c.prototype).obtainMap("watch");N&&N.forEach((S,M)=>{(Array.isArray(S)?S:[S]).forEach(O=>{if(!s.watch[O.key])s.watch[O.key]=O;else{const f=s.watch[O.key];Array.isArray(f)?f.push(O):s.watch[O.key]=[f,O]}})})}o.build=C},41886:function(Q,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.applyAccessors=void 0;function t(p,n){var C;(C=p.beforeCreateCallbacks)!==null&&C!==void 0||(p.beforeCreateCallbacks=[]),p.beforeCreateCallbacks.push(function(){const c=this;n(c).forEach((v,g)=>{Object.defineProperty(c,g,v)})})}o.applyAccessors=t},91274:function(Q,o,t){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.optoinNullableMemberDecorator=o.getValidNames=o.excludeNames=o.getSuperSlot=o.toComponentReverse=o.makeObject=o.obtainSlot=o.getSlot=o.makeSlot=void 0;const p=t(64210),n=Symbol("vue-facing-decorator-slot");class C{constructor(u){this.names=new Map,this.inComponent=!1,this.cachedVueComponent=null,this.master=u}obtainMap(u){let m=this.names.get(u);return m||(m=new Map,this.names.set(u,m)),m}}function c(f){if(s(f))throw"";const u=new C(f);return Object.defineProperty(f,n,{enumerable:!1,value:u}),u}o.makeSlot=c;function s(f){var u;return(u=Object.getOwnPropertyDescriptor(f,n))===null||u===void 0?void 0:u.value}o.getSlot=s;function v(f){const u=s(f);return u||c(f)}o.obtainSlot=v;function g(f,u){return f.reduce((m,j)=>(m[j]=u[j],m),{})}o.makeObject=g;function N(f){const u=[];let m=f;do u.unshift(m),m=Object.getPrototypeOf(m);while(m.constructor!==p.Base&&!s(m));return u}o.toComponentReverse=N;function S(f){let u=Object.getPrototypeOf(f);for(;u.constructor!==p.Base;){const m=s(u);if(m)return m;u=Object.getPrototypeOf(u)}return null}o.getSuperSlot=S;function M(f,u){return f.filter(m=>{for(const j of u.names.keys()){if(["watch","hooks"].includes(j))continue;if(u.names.get(j).has(m))return!1}return!0})}o.excludeNames=M;function L(f,u){const m=Object.getOwnPropertyDescriptors(f);return Object.keys(m).filter(j=>u(m[j],j))}o.getValidNames=L;function O(f){function u(m,j){if(j)f(m,j);else return function(F,w){f(F,w,m)}}return u}o.optoinNullableMemberDecorator=O},62693:function(Q,o,t){"use strict";var p=t(38600);Object.defineProperty(o,"__esModule",{value:!0}),o.TARGET_TYPE=o.STRING_CONDITION_METHOD_LIST=o.NUMBER_CONDITION_METHOD_LIST=o.MetricDetail=o.LOG_CONDITION_METHOD_LIST=o.INTERVAL_UNIT_LIST=o.INTERVAL_LIST=o.CONDITION_METHOD_LIST=o.CONDITION=void 0,t(37209),t(84873),t(17369),t(4064),t(99057),t(3105),t(71342),t(58146);var n=p(t(63638)),C=[{id:"auto",name:"auto"},{id:1,name:1},{id:2,name:2},{id:5,name:5},{id:10,name:10},{id:30,name:30},{id:60,name:60},{id:120,name:120},{id:300,name:300},{id:600,name:600},{id:900,name:900}];o.INTERVAL_LIST=C;var c=[{id:"m",name:"min"},{id:"s",name:"s"},{id:"h",name:"hour"},{id:"d",name:"day"}];o.INTERVAL_UNIT_LIST=c;var s=[{id:"eq",name:"="},{id:"gt",name:">"},{id:"gte",name:">="},{id:"lt",name:"<"},{id:"lte",name:"<="},{id:"neq",name:"!="},{id:"include",name:"include"},{id:"exclude",name:"exclude"},{id:"reg",name:"regex"}];o.CONDITION_METHOD_LIST=s;var v=[{id:"eq",name:"="},{id:"gt",name:">"},{id:"gte",name:">="},{id:"lt",name:"<"},{id:"lte",name:"<="},{id:"neq",name:"!="},{id:"include",name:"include"},{id:"exclude",name:"exclude"},{id:"reg",name:"regex"}];o.NUMBER_CONDITION_METHOD_LIST=v;var g=[{id:"is",name:"is"},{id:"is one of",name:"is one of"},{id:"is not",name:"is not"},{id:"is not one of",name:"is not one of"}];o.LOG_CONDITION_METHOD_LIST=g;var N=[{id:"eq",name:"="},{id:"neq",name:"!="},{id:"include",name:"include"},{id:"exclude",name:"exclude"},{id:"reg",name:"regex"}];o.STRING_CONDITION_METHOD_LIST=N;var S;o.TARGET_TYPE=S,function(O){O.HOST="HOST",O.SERVICE_INSTANCE="SERVICE_INSTANCE",O.NONE="NONE"}(S||(o.TARGET_TYPE=S={}));var M=[{id:"or",name:"OR"},{id:"and",name:"AND"}];o.CONDITION=M;class L{constructor(f){var u=this,m,j,F,w;(0,n.default)(this,"collect_interval",void 0),(0,n.default)(this,"condition_methods",void 0),(0,n.default)(this,"data_source_label",void 0),(0,n.default)(this,"data_source_label_name",void 0),(0,n.default)(this,"data_type_label",void 0),(0,n.default)(this,"default_condition",[]),(0,n.default)(this,"default_dimensions",void 0),(0,n.default)(this,"description",void 0),(0,n.default)(this,"dimensions",void 0),(0,n.default)(this,"extend_fields",void 0),(0,n.default)(this,"id",void 0),(0,n.default)(this,"metric_field",void 0),(0,n.default)(this,"metric_field_name",void 0),(0,n.default)(this,"name",void 0),(0,n.default)(this,"related_id",void 0),(0,n.default)(this,"related_name",void 0),(0,n.default)(this,"result_table_id",void 0),(0,n.default)(this,"result_table_label",void 0),(0,n.default)(this,"result_table_label_name",void 0),(0,n.default)(this,"result_table_name",void 0),(0,n.default)(this,"unit",void 0),(0,n.default)(this,"method_list",void 0),(0,n.default)(this,"agg_interval_unit_list",c),(0,n.default)(this,"agg_interval_list",C),(0,n.default)(this,"index_set_id",""),(0,n.default)(this,"agg_interval",60),(0,n.default)(this,"agg_interval_unit","s"),(0,n.default)(this,"alias",""),(0,n.default)(this,"agg_method","AVG"),(0,n.default)(this,"agg_dimension",void 0),(0,n.default)(this,"agg_condition",[]),(0,n.default)(this,"functions",[]),(0,n.default)(this,"display",!0),(0,n.default)(this,"refId",""),(0,n.default)(this,"mode","ui"),(0,n.default)(this,"source",""),(0,n.default)(this,"loading",!1),(0,n.default)(this,"status","default"),Object.keys(f).forEach(function(I){return u[I]=f[I]}),this.agg_method=f.agg_method||(this.onlyCountMethod?"COUNT":f!=null&&(m=f.method_list)!==null&&m!==void 0&&m.length?f.method_list[0]:"AVG"),this.agg_dimension=f.agg_dimension||f.default_dimensions||[];var P=(f.agg_condition||((j=f.default_condition)!==null&&j!==void 0&&j.length?f.default_condition:[{}])).slice();(F=P[P.length-1])!==null&&F!==void 0&&F.key&&P.push({}),this.agg_condition=P,this.index_set_id=(f==null||(w=f.extend_fields)===null||w===void 0?void 0:w.index_set_id)||""}get curMetricId(){return"".concat(this.data_source_label,"|").concat(this.data_type_label,"|").concat(this.result_table_id,"|").concat(this.metric_field)}get metricMetaId(){return"".concat(this.data_source_label,"|").concat(this.data_type_label)}get canSetMulitpeMetric(){return["bk_monitor|time_series","custom|time_series"].includes(this.metricMetaId)&&!this.result_table_id.match(/^uptimecheck/i)&&!this.isSpecialCMDBDimension}get isSpecialCMDBDimension(){return this.metricMetaId==="bk_monitor|time_series"&&(this.agg_dimension.some(function(f){return["bk_inst_id","bk_obj_id"].includes(f)})||this.agg_condition.some(function(f){return["bk_inst_id","bk_obj_id"].includes(f.key)}))}get canSetRealTimeSearch(){return["bk_monitor|time_series","custom|time_series","bk_monitor|event"].includes(this.metricMetaId)}get canSetConvergeSearch(){return this.metricMetaId!=="bk_monitor|event"}get canSetSourceCode(){return this.data_type_label==="time_series"&&this.data_source_label!=="bk_log_search"}get canSetDimension(){return this.metricMetaId!=="bk_monitor|event"}get canSetAggMethod(){return this.metricMetaId!=="bk_monitor|event"}get canSetAggInterval(){return this.metricMetaId!=="bk_monitor|event"}get canSetQueryString(){return this.data_source_label!=="bk_monitor"&&this.data_type_label==="log"}get canSetFunction(){return this.metricMetaId!=="bk_monitor|event"}get canSetMetricCalc(){return!0}get isAllFunc(){return["bk_monitor|time_series","custom|time_series"].includes(this.metricMetaId)&&!this.result_table_id.match(/^uptimecheck/i)&&!this.isSpecialCMDBDimension}get aggMethodList(){var f;return this.onlyCountMethod?[{id:"COUNT",name:"COUNT"}]:this!==null&&this!==void 0&&(f=this.method_list)!==null&&f!==void 0&&f.length?this.method_list.map(function(u){return{id:u,name:u}}):[]}get onlyCountMethod(){return["bk_log_search|log","custom|event"].includes(this.metricMetaId)||this.metricMetaId==="bk_monitor|time_series"&&this.result_table_id==="uptimecheck.http"&&["message","response_code"].includes(this.metric_field)}get targetType(){return["os","host_device","host_process"].includes(this.result_table_label)?S.HOST:["service_module","component"].includes(this.result_table_label)?S.SERVICE_INSTANCE:S.NONE}}o.MetricDetail=L},71997:function(Q,o,t){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var p=t(30327),n=(0,p.defineStore)({id:"panelEditor",state:function(){return{panel:null}},actions:{savePanel(c){this.panel=c}}}),C=n;o.default=C},89345:function(Q,o,t){"use strict";var p=t(38600);Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0,t(20148),t(50754);var n=t(70748),C=p(t(63638)),c=t(35385),s=t(64210),v=t(22247),g=class extends(0,s.TSX)()(s.Vue){constructor(){super(...arguments),(0,C.default)(this,"current",[]),(0,C.default)(this,"height",void 0),(0,C.default)(this,"list",void 0),(0,C.default)(this,"value",void 0)}change(M){return this.current=M,this.current}handleCurrentChange(){this.change(this.current)}created(){this.current=[...this.value]}render(){var M=this;return(0,n.createVNode)("div",{class:"function-cascade",style:{position:"relative"}},[(0,n.createVNode)(v.Cascader,{modelValue:M.current,"onUpdate:modelValue":function(O){return M.current=O},list:this.list,clearable:!0,class:"full-width",style:{height:this.height},extCls:"function-content",showCompleteName:!1},null)])}};(0,c.__decorate)([(0,s.Prop)({type:String,default:"32px"})],g.prototype,"height",void 0),(0,c.__decorate)([(0,s.Prop)({type:Array,default:function(){return[]}})],g.prototype,"list",void 0),(0,c.__decorate)([(0,s.VModel)({default:[]})],g.prototype,"value",void 0),(0,c.__decorate)([(0,s.Emit)("change")],g.prototype,"change",null),(0,c.__decorate)([(0,s.Watch)("current",{deep:!0})],g.prototype,"handleCurrentChange",null),g=(0,c.__decorate)([s.Component],g);var N=g;o.default=N},50647:function(Q,o,t){"use strict";t(81821),t(34),t(84873),t(1714);var p=t(38600);Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0,t(6125),t(20148),t(50754),t(14775),t(37209),t(35340),t(9100),t(88322);var n=t(70748),C=p(t(65809)),c=p(t(63638)),s=t(35385),v=t(64210),g=t(22247),N=t(92244);function S(f,u){var m=Object.keys(f);if(Object.getOwnPropertySymbols){var j=Object.getOwnPropertySymbols(f);u&&(j=j.filter(function(F){return Object.getOwnPropertyDescriptor(f,F).enumerable})),m.push.apply(m,j)}return m}function M(f){for(var u=1;u<arguments.length;u++){var m=arguments[u]!=null?arguments[u]:{};u%2?S(Object(m),!0).forEach(function(j){(0,c.default)(f,j,m[j])}):Object.getOwnPropertyDescriptors?Object.defineProperties(f,Object.getOwnPropertyDescriptors(m)):S(Object(m)).forEach(function(j){Object.defineProperty(f,j,Object.getOwnPropertyDescriptor(m,j))})}return f}var L=class extends(0,v.TSX)()(v.Vue){constructor(){super(...arguments),(0,c.default)(this,"metricList",[]),(0,c.default)(this,"selectedList",[]),(0,c.default)(this,"obj",{text:[],metric:{}}),(0,c.default)(this,"key","key"),(0,c.default)(this,"bizId",void 0),(0,c.default)(this,"dropList",void 0),(0,c.default)(this,"chooseList",void 0),(0,c.default)(this,"value",void 0)}change(){return this.obj}handleTextChange(){this.change()}handleDropListChange(){this.selectedList=this.chooseList,this.metricList=this.dropList,this.key="key_".concat(Math.random()*100)}handleValueChange(){this.obj=this.value,this.key="key_".concat(Math.random()*100)}created(){var u=this;return(0,C.default)(regeneratorRuntime.mark(function m(){var j,F;return regeneratorRuntime.wrap(function(P){for(;;)switch(P.prev=P.next){case 0:if(!((j=u.value)!==null&&j!==void 0&&(F=j.text)!==null&&F!==void 0&&F.length)){P.next=4;break}u.selectedList=[...u.chooseList],P.next=7;break;case 4:return P.next=6,(0,N.getQueryMetricLevel)({level:"result_table_label",bk_biz_id:u.bizId});case 6:u.metricList=P.sent;case 7:u.obj=u.value;case 8:case"end":return P.stop()}},m)}))()}changeValue(){var u=this;this.obj.text.length?this.obj.metric=this.selectedList[3].children.find(function(m){return m.id===u.obj.text[4]}):(this.selectedList=[],this.obj.metric=null),this.change()}getCurrentIndex(u){for(var m=["result_table_label","data_source","related_id","result_table_id"],j=0,F=null,w=0;w<m.length;w++)Object.prototype.hasOwnProperty.call(u,m[w])&&(F=w,j+=1);return j>1?-1:F}remoteMethod(u,m){u.isLoading===!1&&u?m(u):(u.isLoading=!0,this.handleGetMetricLevelData(u,m,this.bizId,this.selectedList))}handleGetMetricLevelData(u,m,j,F){var w=this;return(0,C.default)(regeneratorRuntime.mark(function P(){var I,U,k,H,z,R,_,y,l,e,a,r,i;return regeneratorRuntime.wrap(function(b){for(;;)switch(b.prev=b.next){case 0:if(R=w.getCurrentIndex(u),!(R<0||u.children)){b.next=4;break}return m(u),b.abrupt("return");case 4:if(console.log("#### this.selectedList",F),F.splice(R,4-R,u),_=(I=F[1])===null||I===void 0||(U=I.data_source)===null||U===void 0?void 0:U.split("."),y=[],l=((k=F[0])===null||k===void 0?void 0:k.id)||"",!(F.length<4)){b.next=26;break}e={},a={data_source_label:_?.[0]||"",data_type_label:_?.[1]||""},b.t0=F.length,b.next=b.t0===1?15:b.t0===2?17:b.t0===3?19:21;break;case 15:return e={level:"data_source",conditions:{result_table_label:l}},b.abrupt("break",21);case 17:return e={level:"related_id",conditions:M({result_table_label:l},a)},b.abrupt("break",21);case 19:return e={level:"result_table_id",conditions:M({result_table_label:l,related_id:((H=F[2])===null||H===void 0?void 0:H.related_id)||""},a)},b.abrupt("break",21);case 21:return b.next=23,(0,N.getQueryMetricLevel)(M(M({},e),{},{bk_biz_id:j}));case 23:y=b.sent,b.next=29;break;case 26:return b.next=28,(0,N.getMetricDetailByUid)({result_table_label:l,conditions:M({data_source_label:_[0],data_type_label:_[1]},Object.assign({},(r=F[3])!==null&&r!==void 0&&r.result_table_name?{result_table_name:F[3].result_table_name}:{result_table_id:((i=F[3])===null||i===void 0?void 0:i.result_table_id)||""})),flat_format:!0,bk_biz_id:j});case 28:y=b.sent;case 29:u&&(z=y)!==null&&z!==void 0&&z.length&&(u.children=y),u&&(u.loading=!1),m(u);case 32:case"end":return b.stop()}},P)}))()}render(){var u=this;return(0,n.createVNode)(g.Cascader,{key:this.key,ref:"metricInput",modelValue:u.obj.text,"onUpdate:modelValue":function(j){return u.obj.text=j},list:this.metricList,isRemote:!0,remoteMethod:this.remoteMethod,clearable:!0,class:"full-width",onChange:this.changeValue},null)}};(0,s.__decorate)([(0,v.Prop)({type:Number})],L.prototype,"bizId",void 0),(0,s.__decorate)([(0,v.Prop)({type:Array})],L.prototype,"dropList",void 0),(0,s.__decorate)([(0,v.Prop)({type:Array})],L.prototype,"chooseList",void 0),(0,s.__decorate)([(0,v.VModel)()],L.prototype,"value",void 0),(0,s.__decorate)([(0,v.Emit)("change")],L.prototype,"change",null),(0,s.__decorate)([(0,v.Watch)("obj.text",{deep:!0})],L.prototype,"handleTextChange",null),(0,s.__decorate)([(0,v.Watch)("dropList",{deep:!0})],L.prototype,"handleDropListChange",null),(0,s.__decorate)([(0,v.Watch)("value",{deep:!0})],L.prototype,"handleValueChange",null),L=(0,s.__decorate)([v.Component],L);var O=L;o.default=O},64672:function(Q,o,t){"use strict";t(81821),t(1714);var p=t(38600);Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0,t(6125),t(20148),t(50754),t(16165),t(37209),t(14775),t(35340),t(97870),t(34),t(58146),t(84873),t(9100),t(25528);var n=t(70748),C=p(t(64375)),c=p(t(65809)),s=p(t(63638)),v=t(35385),g=t(64210),N=t(22247),S=t(12692),M=t(71633),L=t(62693),O=t(92244),f=p(t(89345)),u=p(t(33370)),m=p(t(50647)),j=p(t(5642)),F=t(11016),w=p(t(56350));t(99986);var P=t(36473),I=p(t(71997));function U(l,e){var a=Object.keys(l);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(l);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(l,i).enumerable})),a.push.apply(a,r)}return a}function k(l){for(var e=1;e<arguments.length;e++){var a=arguments[e]!=null?arguments[e]:{};e%2?U(Object(a),!0).forEach(function(r){(0,s.default)(l,r,a[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(l,Object.getOwnPropertyDescriptors(a)):U(Object(a)).forEach(function(r){Object.defineProperty(l,r,Object.getOwnPropertyDescriptor(a,r))})}return l}function H(l){return typeof l=="function"||Object.prototype.toString.call(l)==="[object Object]"&&!(0,n.isVNode)(l)}var z=(0,I.default)(),R=N.Select.Option,_=class extends(0,g.TSX)()(w.default){constructor(){super(...arguments),(0,s.default)(this,"indicatorForm",new Map),(0,s.default)(this,"targetForm",new Map),(0,s.default)(this,"functionsForm",new Map),(0,s.default)(this,"paramsList",{}),(0,s.default)(this,"dimensionsList",[]),(0,s.default)(this,"conditionMethods",[]),(0,s.default)(this,"whereValueList",[]),(0,s.default)(this,"clusterList",[]),(0,s.default)(this,"moduleList",[]),(0,s.default)(this,"hostList",[]),(0,s.default)(this,"funList",[]),(0,s.default)(this,"metricList",[]),(0,s.default)(this,"selectedList",[]),(0,s.default)(this,"formData",[]),(0,s.default)(this,"expendList",[]),(0,s.default)(this,"timeList",{monitor:[{name:"time",type:"timestamp"}]}),(0,s.default)(this,"panelModel",void 0)}get bizId(){var e,a,r=this;return((e=P.DataSourceModule.datasourceList.find(function(i){return i.uid===r.panelModel.datasource.uid}))===null||e===void 0||(a=e.json_data)===null||a===void 0?void 0:a.bk_biz_id)||""}init(){if(this.bizId){this.getFunList(),this.getClusterList(),this.initData();debugger}}initData(){var e=this;return(0,c.default)(regeneratorRuntime.mark(function a(){var r,i,d;return regeneratorRuntime.wrap(function(V){for(;;)switch(V.prev=V.next){case 0:if(e.expendList.splice(0,500),e.formData=[],!(e.panelModel.datasource&&(r=e.panelModel.query)!==null&&r!==void 0&&r.length&&z.panel.datasource.uid===e.panelModel.datasource.uid)){V.next=12;break}i=regeneratorRuntime.mark(function T(h){var E,B,A,$,D,G,X,x,J,W,Y,te,ae;return regeneratorRuntime.wrap(function(K){for(;;)switch(K.prev=K.next){case 0:return e.whereValueList.push([[]]),E=e.panelModel.query[h],B=E.target,A=E.query_configs[0],$=A.functions,D=A.data_source_label,G=A.data_type_label,X=A.result_table_label,x=A.related_id,J=A.metrics,W=A.table,Y=A.where,e.initTarget(B,h),te=e.funList.reduce(function(ee,q){var ne;return q!=null&&(ne=q.children)!==null&&ne!==void 0&&ne.length?[...ee,...q.children]:ee},[]),ae=$.map(function(ee){var q=te.find(function(ne){return ne.id===ee.id});if(q)return{id:[q.category,q.uid],params:ee.params}}).filter(function(ee){return ee!==void 0}),e.functionsForm.set(h,ae),e.indicatorForm.set(h,{text:[],metric:{}}),K.next=11,e.initMetric({dataSourceLabel:D,dataTypeLabel:G,table:W,metric:J[0],result_table_label:X,related_id:x},h);case 11:Y.forEach(function(ee,q){e.getWhereValue(ee.key,h,q)}),e.handleIndicatorChange(h),e.functionsForm.get(h).forEach(function(ee,q){e.getParams(h,q,ee.id)}),e.expendList.push(h);case 15:case"end":return K.stop()}},T)}),d=0;case 5:if(!(d<e.panelModel.query.length)){V.next=10;break}return V.delegateYield(i(d),"t0",7);case 7:d++,V.next=5;break;case 10:V.next=13;break;case 12:e.addQuery();case 13:case"end":return V.stop()}},a)}))()}initMetric(e,a){var r=this;return(0,c.default)(regeneratorRuntime.mark(function i(){var d,b,V,T,h,E,B,A,$,D,G,X,x,J,W,Y,te;return regeneratorRuntime.wrap(function(Z){for(;;)switch(Z.prev=Z.next){case 0:return V=e.dataSourceLabel,T=e.dataTypeLabel,h=e.result_table_label,E=e.related_id,B=e.table,A=e.metric,$=[],D=[],Z.next=5,(0,O.getQueryMetricLevel)({level:"result_table_label",bk_biz_id:r.bizId});case 5:return G=Z.sent,X=G.find(function(K){return K.result_table_label===h}),$.push(X.id),D.push(X),Z.next=11,(0,O.getQueryMetricLevel)({level:"data_source",bk_biz_id:r.bizId,conditions:{result_table_label:h}});case 11:return X.children=Z.sent,x=[V,T].join("."),J=X.children.find(function(K){return K.data_source===x}),$.push(J.id),D.push(J),Z.next=18,(0,O.getQueryMetricLevel)({level:"related_id",bk_biz_id:r.bizId,conditions:{result_table_label:h,data_type_label:T,data_source_label:V}});case 18:return J.children=Z.sent,W=J.children.find(function(K){return K.related_id===E}),$.push(W.id),D.push(W),Z.next=24,(0,O.getQueryMetricLevel)({level:"result_table_id",bk_biz_id:r.bizId,conditions:{result_table_label:h,related_id:E,data_type_label:T,data_source_label:V}});case 24:return W.children=Z.sent,Y=W.children.find(function(K){return K.result_table_id===B}),D.push(Y),$.push(Y.id),Z.next=30,(0,O.getMetricDetailByUid)({result_table_label:h,conditions:k({data_source_label:V,data_type_label:T},Object.assign({},(d=D[3])!==null&&d!==void 0&&d.result_table_name?{result_table_name:D[3].result_table_name}:{result_table_id:((b=D[3])===null||b===void 0?void 0:b.result_table_id)||""})),flat_format:!0,bk_biz_id:r.bizId});case 30:Y.children=Z.sent,te=Y.children.find(function(K){return K.id===A.field}),$.push(te.id),G.splice(G.findIndex(function(K){return K.result_table_label===h}),1,X),r.metricList[a]=G,r.selectedList[a]=D;debugger;r.indicatorForm.set(a,{text:$,metric:te});case 38:case"end":return Z.stop()}},i)}))()}initTarget(e,a){var r=this;if(this.targetForm.has(a)||this.targetForm.set(a,[[],[],[]]),e.length){var i=this.targetForm.get(a),d=e.filter(function(V){return!!V.bk_inst_id}),b=e.filter(function(V){return!!V.bk_target_ip});i[0]=d.filter(function(V){return r.clusterList.some(function(T){return T.value===V.bk_inst_id})}).map(function(V){return V.bk_inst_id}),this.handleGetModuleList(i[0]).then(function(V){i[1]=d.filter(function(T){return V.some(function(h){return h.value===T.bk_inst_id})}).map(function(T){return T.bk_inst_id}),r.handleGetHostList(i[0],i[1]).then(function(T){i[2]=b.filter(function(h){return T.some(function(E){return E.value===h.bk_target_ip})}).map(function(h){return h.bk_target_ip})})})}}addOption(e,a,r){console.log(e,a,r)}deleteOption(e,a,r){console.log(e,a,r)}addQuery(){var e=M.Letters[this.formData.length];this.formData.push(new S.BkMonitorQueryConfig(e)),this.whereValueList.push([[]]),this.dimensionsList.push([]),this.conditionMethods.push([]),this.metricList.push([]),this.selectedList.push([]),this.expendList=[],this.expendList.push(this.formData.length-1)}deleteQuery(e,a){e.stopPropagation(),this.formData.splice(a,1),this.whereValueList.splice(a,1),this.dimensionsList.splice(a,1),this.conditionMethods.splice(a,1),this.expendList.splice(a,1),this.metricList.splice(a,1),this.selectedList.splice(a,1);for(var r=0;r<this.formData.length;r++)this.formData[r].ref_id=M.Letters[r]}handleIndicatorChange(e){if(this.indicatorForm.get(e).metric){var a=this.indicatorForm.get(e).metric,r=a.dimensions,i=a.condition_methods;this.dimensionsList.splice(e,1,r),this.conditionMethods.splice(e,1,i)}else this.dimensionsList.splice(0,500),this.conditionMethods.splice(0,500),this.formData[e].query_configs[e].group_by=[],this.formData[e].query_configs[e].where=[]}getWhereValue(e,a,r){var i=this;if(this.indicatorForm.get(a).metric){var d=this.indicatorForm.get(a).metric,b=d.result_table_id,V=d.metric_field,T=d.data_source_label,h=d.data_type_label;(0,O.getVariableValueList)({type:"dimension",params:{result_table_id:b,metric_field:V,data_source_label:T,data_type_label:h,field:e,where:[],start_time:new Date().getTime()-24*60*60*1e3,end_time:new Date().getTime()},bk_biz_id:this.bizId}).then(function(E){i.whereValueList[a][r].splice(0,500,...E)})}}handleClusterChange(e,a){var r=this;return(0,c.default)(regeneratorRuntime.mark(function i(){var d,b,V,T;return regeneratorRuntime.wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return E.next=2,r.handleGetModuleList(a);case 2:return d=E.sent,b=r.targetForm.get(e)[1].filter(function(B){return d.some(function(A){return A.value===B})}),r.targetForm.get(e)[1]=b,E.next=7,r.handleGetHostList(r.targetForm.get(e)[0],r.targetForm.get(e)[1]);case 7:V=E.sent,T=r.targetForm.get(e)[2].filter(function(B){return V.some(function(A){return A.value===B})}),r.targetForm.get(e)[2]=T;case 10:case"end":return E.stop()}},i)}))()}handleModuleChange(e,a){var r=this;return(0,c.default)(regeneratorRuntime.mark(function i(){var d,b;return regeneratorRuntime.wrap(function(T){for(;;)switch(T.prev=T.next){case 0:return T.next=2,r.handleGetHostList(r.targetForm.get(e)[0],a);case 2:d=T.sent,b=r.targetForm.get(e)[2].filter(function(h){return d.some(function(E){return E.value===h})}),r.targetForm.get(e)[2]=b;case 5:case"end":return T.stop()}},i)}))()}getClusterList(){var e=this;return(0,c.default)(regeneratorRuntime.mark(function a(){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,(0,O.getVariableValueList)({params:{label_field:"bk_set_name",value_field:"bk_set_id",where:[]},type:"set",bk_biz_id:e.bizId});case 2:e.clusterList=i.sent;case 3:case"end":return i.stop()}},a)}))()}getFunList(){var e=this;return(0,c.default)(regeneratorRuntime.mark(function a(){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,(0,O.getFunctions)({bk_biz_id:e.bizId,type:"grafana"});case 2:e.funList=i.sent;case 3:case"end":return i.stop()}},a)}))()}handleGetModuleList(e){var a=this;return(0,c.default)(regeneratorRuntime.mark(function r(){var i,d;return regeneratorRuntime.wrap(function(V){for(;;)switch(V.prev=V.next){case 0:if(i=[],!(e!=null&&e.length)){V.next=7;break}return d={params:{label_field:"bk_module_name",value_field:"bk_module_id",where:[{key:"bk_set_id",method:"eq",value:e}]},type:"module",bk_biz_id:a.bizId},V.next=5,(0,O.getVariableValueList)(d).catch(function(){return[]});case 5:i=V.sent,a.moduleList=i;case 7:return V.abrupt("return",i);case 8:case"end":return V.stop()}},r)}))()}handleGetHostList(e,a){var r=this;return(0,c.default)(regeneratorRuntime.mark(function i(){var d,b;return regeneratorRuntime.wrap(function(T){for(;;)switch(T.prev=T.next){case 0:if(d=[],!(a!=null&&a.length)){T.next=6;break}return b={params:{label_field:"bk_host_innerip",value_field:"bk_host_innerip|bk_cloud_id",where:[{key:"bk_set_id",method:"eq",value:e},{key:"bk_module_ids",method:"eq",value:a}]},type:"host",bk_biz_id:r.bizId},T.next=5,(0,O.getVariableValueList)(b).catch(function(){return[]});case 5:d=T.sent;case 6:return r.hostList=d,T.abrupt("return",d);case 8:case"end":return T.stop()}},i)}))()}getParams(e,a,r){var i=this,d=this.funList.find(function(V){return V.id===r[0]}),b=d.children.find(function(V){return V.id===r[1]});this.paramsList[r[1]]=b.params,this.formData[e].query_configs[e].functions[a].params=[],b.params.length?b.params.forEach(function(V){i.formData[e].query_configs[e].functions[a].params.push({id:V.id,value:V.default})}):this.formData[e].query_configs[e].functions[a].params=[]}changeWhereItemType(e,a,r){if(!a){Object.assign(e,{type:"",aggregate:""});return}var i=this.timeList[r].find(function(d){return d.name===a});if(!i){(0,N.Message)({theme:"error",message:"\u6CA1\u6709\u627E\u5230\u8BE5\u680F\u7684\u6570\u636E\u7C7B\u578B"});return}Object.assign(e,{type:i.type})}getTimeRangeFromFilter(e){var a=e.from,r=e.to;return!a||!r?F.DEFAULT_TIME_RANGE:[a,r]}handleTimeRangeChange(e,a){var r=(0,C.default)(e,2),i=r[0],d=r[1];Object.assign(a,{from:i,to:d})}render(){var e=this,a=function(T){return(0,n.createVNode)(u.default,{modelValue:T.params,"onUpdate:modelValue":function(E){return T.params=E},list:e.paramsList[T.id[1]]},null)},r=function(T){var h=e.indicatorForm.get(T);return(0,n.createVNode)("div",{class:"flex-row source-item-container"},[(0,n.createVNode)("p",{class:"source-item-label flex-row align-items-center mb5 mr10 pl15 pr15"},[(0,n.createTextVNode)("\u6307\u6807\uFF08\u5FC5\u9009\uFF09")]),(0,n.createVNode)("div",{class:"source-form-item-panel flex-row flex-wrap"},[(0,n.createVNode)("div",{class:"source-select-item large-item flex-row"},[(0,n.createVNode)(m.default,{bizId:e.bizId,dropList:e.metricList[T]||[],chooseList:e.selectedList[T],modelValue:h,"onUpdate:modelValue":function(B){return h=B},onChange:function(){return e.handleIndicatorChange(T)}},null)])])])},i=function(T){var h,E,B,A=e.targetForm.get(T);return(0,n.createVNode)("div",{class:"flex-row source-item-container"},[(0,n.createVNode)("p",{class:"source-item-label flex-row align-items-center mb5 mr10 pl15 pr15"},[(0,n.createTextVNode)("\u76EE\u6807\uFF08\u53EF\u9009\uFF09")]),(0,n.createVNode)("div",{class:"source-form-item-panel flex-row flex-wrap"},[(0,n.createVNode)("div",{class:"source-select-item"},[(0,n.createVNode)(N.Select,{placeholder:"\u96C6\u7FA4",multiple:!0,multipleMode:"tag",allowCreate:!0,showSelectAll:!0,class:"flex-1",onChange:function(D){return e.handleClusterChange(T,D)},modelValue:A[0],"onUpdate:modelValue":function(D){return A[0]=D}},H(h=e.clusterList.map(function($){return(0,n.createVNode)(R,{key:$.value,value:$.value,label:$.label},null)}))?h:{default:function(){return[h]}})]),(0,n.createVNode)("div",{class:"source-select-item"},[(0,n.createVNode)(N.Select,{placeholder:"\u6A21\u5757",multiple:!0,multipleMode:"tag",showSelectAll:!0,allowCreate:!0,onChange:function(D){return e.handleModuleChange(T,D)},class:"flex-1",modelValue:A[1],"onUpdate:modelValue":function(D){return A[1]=D}},H(E=e.moduleList.map(function($){return(0,n.createVNode)(R,{key:$.value,value:$.value,label:$.label},null)}))?E:{default:function(){return[E]}})]),(0,n.createVNode)("div",{class:"source-select-item"},[(0,n.createVNode)(N.Select,{multiple:!0,multipleMode:"tag",placeholder:"\u4E3B\u673A",allowCreate:!0,class:"flex-1",showSelectAll:!0,modelValue:A[2],"onUpdate:modelValue":function(D){return A[2]=D}},H(B=e.hostList.map(function($){return(0,n.createVNode)(R,{key:$.value,value:$.value,label:$.label},null)}))?B:{default:function(){return[B]}})])])])},d=function(T,h){var E,B,A,$;return(0,n.createVNode)("div",{class:"flex-wrap flex-1",key:h},[r(h),(0,n.createVNode)("div",{class:"flex-row source-item-container"},[(0,n.createVNode)("p",{class:"source-item-label flex-row align-items-center mb5 mr10 pl15 pr15"},[(0,n.createTextVNode)("\u65B9\u6CD5\uFF08\u5FC5\u9009\uFF09")]),(0,n.createVNode)("div",{class:"source-form-item-panel"},[(0,n.createVNode)("div",{class:"source-select-item large-item flex-row"},[(0,n.createVNode)(N.Select,{placeholder:"\u65B9\u6CD5",class:"flex-1",clearable:!0,modelValue:T.query_configs[h].metrics[0].method,"onUpdate:modelValue":function(G){return T.query_configs[h].metrics[0].method=G}},H(B=M.AGGREGATION_LIST.map(function(D){return(0,n.createVNode)(R,{key:D.id,value:D.name,label:D.name},null)}))?B:{default:function(){return[B]}})])])]),(0,n.createVNode)("div",{class:"flex-row source-item-container"},[(0,n.createVNode)("p",{class:"source-item-label flex-row align-items-center mb5 mr10 pl15 pr15"},[(0,n.createTextVNode)("\u5468\u671F\uFF08\u5FC5\u9009\uFF09")]),(0,n.createVNode)("div",{class:"source-form-item-panel flex-row"},[(0,n.createVNode)("div",{class:"source-select-item large-item flex-row flex-row"},[(0,n.createVNode)(N.Select,{placeholder:"\u65F6\u95F4",class:"flex-1",clearable:!0,modelValue:T.query_configs[0].interval,"onUpdate:modelValue":function(G){return T.query_configs[0].interval=G}},H(A=L.INTERVAL_LIST.map(function(D){return(0,n.createVNode)(R,{key:D.id,value:D.id,label:String(D.name)},null)}))?A:{default:function(){return[A]}}),(0,n.createVNode)(N.Select,{placeholder:"\u5355\u4F4D",class:"flex-1",modelValue:T.query_configs[0].interval_unit,"onUpdate:modelValue":function(G){return T.query_configs[0].interval_unit=G},clearable:!0},H($=L.INTERVAL_UNIT_LIST.map(function(D){return(0,n.createVNode)(R,{key:D.id,value:D.id,label:D.name},null)}))?$:{default:function(){return[$]}})])])]),(0,n.createVNode)("div",{class:"flex-row source-item-container"},[(0,n.createVNode)("p",{class:"source-item-label flex-row align-items-center mb5 mr10 pl15 pr15"},[(0,n.createTextVNode)("\u7EF4\u5EA6\uFF08\u53EF\u9009\uFF09")]),(0,n.createVNode)("div",{class:"source-form-item-panel"},[(0,n.createVNode)("div",{class:"source-select-item large-item flex-row"},[(0,n.createVNode)(N.Select,{placeholder:"\u7EF4\u5EA6","ext-cls":"flex-1",multiple:!0,multipleMode:"tag",clearable:!0,modelValue:T.query_configs[0].group_by,"onUpdate:modelValue":function(G){return T.query_configs[0].group_by=G}},{default:function(){return[(E=e.dimensionsList[h])===null||E===void 0?void 0:E.map(function(G){return(0,n.createVNode)(R,{key:G.id,value:G.id,label:G.name},null)})]}})])])]),(0,n.createVNode)("div",{class:"flex-row source-item-container"},[(0,n.createVNode)("p",{class:"source-item-label flex-shrink-0 flex-row align-items-center mb5 mr10 pl15 pr15"},[(0,n.createTextVNode)("\u6761\u4EF6\uFF08\u53EF\u9009\uFF09")]),(0,n.createVNode)("div",{class:"source-form-item-panel flex-row flex-wrap align-items-start "},[T.query_configs[0].where.map(function(D,G){var X,x,J;return(0,n.createVNode)("div",{class:"source-select-item-multi mr5 flex-row",key:G},[(0,n.createVNode)("div",{class:"source-select-item large-item flex-row"},[(0,n.createVNode)(N.Select,{placeholder:"\u7EF4\u5EA6",class:"flex-3 flex-shrink-0",clearable:!0,onChange:function(Y){return e.getWhereValue(Y,h,G)},modelValue:D.key,"onUpdate:modelValue":function(Y){return D.key=Y}},{default:function(){return[(X=e.dimensionsList[h])===null||X===void 0?void 0:X.map(function(Y){return(0,n.createVNode)(R,{key:Y.id,value:Y.id,label:Y.name},null)})]}}),(0,n.createVNode)(N.Select,{placeholder:"\u8FD0\u7B97\u7B26",clearable:!0,class:"flex-2 flex-shrink-0",modelValue:D.method,"onUpdate:modelValue":function(Y){return D.method=Y}},{default:function(){return[(x=e.conditionMethods[h])===null||x===void 0?void 0:x.map(function(Y){return(0,n.createVNode)(R,{key:Y.value,value:Y.value,label:Y.label},null)})]}}),(0,n.createVNode)(N.Select,{class:"flex-3",multiple:!0,multipleMode:"tag",showSelectAll:!0,modelValue:D.value,"onUpdate:modelValue":function(Y){return D.value=Y}},{default:function(){return[(J=e.whereValueList[h][G])===null||J===void 0?void 0:J.map(function(Y){return(0,n.createVNode)(R,{key:Y.value,value:Y.value,label:Y.label},null)})]}})]),(0,n.createVNode)("div",{class:"item-button delete-button ml5 flex-row align-items-center justify-content-center",onClick:function(){return e.deleteOption("where",h,G)}},[(0,n.createVNode)((0,n.resolveComponent)("bk-icon"),{type:"delete"},null)])])}),(0,n.createVNode)("div",{class:"item-button add-button flex-row align-items-center justify-content-center",onClick:function(){return e.addOption("where",h,{key:"",method:"",value:[]})}},[(0,n.createVNode)((0,n.resolveComponent)("bk-icon"),{type:"plus"},null)])])]),(0,n.createVNode)("div",{class:"flex-row source-item-container"},[(0,n.createVNode)("p",{class:"source-item-label flex-shrink-0 flex-row align-items-center mb5 mr10 pl15 pr15"},[(0,n.createTextVNode)("\u51FD\u6570\uFF08\u53EF\u9009\uFF09")]),(0,n.createVNode)("div",{class:"source-form-item-panel flex-row flex-wrap align-items-start"},[e.functionsForm.get(h).map(function(D,G){var X;return(0,n.createVNode)("div",{class:"source-select-item-multi mr5 flex-row",key:G},[(0,n.createVNode)("div",{class:"source-select-item  large-item flex-row"},[(0,n.createVNode)(f.default,{modelValue:D.id,"onUpdate:modelValue":function(J){return D.id=J},list:e.funList,onChange:function(){return e.getParams(h,G,D.id)}},null)]),D.id.length>0&&((X=e.paramsList[D.id[1]])===null||X===void 0?void 0:X.length)>0&&(0,n.createVNode)("div",{class:"source-select-item "},[a(D)]),(0,n.createVNode)("div",{class:"item-button delete-button ml5 flex-row align-items-center justify-content-center",onClick:function(){return e.deleteOption("fun",h,G)}},[(0,n.createVNode)((0,n.resolveComponent)("bk-icon"),{type:"delete"},null)])])}),(0,n.createVNode)("div",{class:"item-button add-button flex-row align-items-center justify-content-center",onClick:function(){return e.addOption("fun",h,{id:[],params:[]})}},[(0,n.createVNode)((0,n.resolveComponent)("bk-icon"),{type:"plus"},null)])])]),i(h),(0,n.createVNode)(j.default,{modelValue:T,"onUpdate:modelValue":function(G){return T=G},list:e.timeList,isShowTime:!1,isShowAggregate:!1,changeWhereItemType:e.changeWhereItemType,getTimeRangeFromFilter:e.getTimeRangeFromFilter,handleTimeRangeChange:e.handleTimeRangeChange},null)])},b=function(T,h){var E;return(0,n.createVNode)("div",null,[(0,n.createVNode)("div",{class:"flex-row align-items-center justify-content-between"},[(0,n.createVNode)("p",{style:{height:"100%",lineHeight:"30px"}},[T.ref_id])]),(0,n.createVNode)("div",null,[(0,n.createVNode)(N.Form,{class:"data-source-form"},H(E=d(T,h))?E:{default:function(){return[E]}})])])};return(0,n.createVNode)("div",{class:"data-source-monitoring data-source-query flex-1 overflow-y-auto"},[(0,n.createVNode)("div",{class:"flex-1"},[this.formData.map(function(V,T){return b(V,T)})])])}};(0,v.__decorate)([(0,g.Prop)()],_.prototype,"panelModel",void 0),_=(0,v.__decorate)([g.Component],_);var y=_;o.default=y},33370:function(Q,o,t){"use strict";var p=t(38600);Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0,t(20148),t(50754),t(34),t(37209),t(58146),t(4064),t(81821),t(6504),t(84873),t(14775);var n=t(70748),C=p(t(63638)),c=t(35385),s=t(64210),v=t(22247);function g(L){return typeof L=="function"||Object.prototype.toString.call(L)==="[object Object]"&&!(0,n.isVNode)(L)}var N=v.Select.Option,S=class extends(0,s.TSX)()(s.Vue){constructor(){super(...arguments),(0,C.default)(this,"current",[]),(0,C.default)(this,"paramsNameList",[]),(0,C.default)(this,"paramsValueList",{}),(0,C.default)(this,"field",""),(0,C.default)(this,"fieldValue",""),(0,C.default)(this,"list",void 0),(0,C.default)(this,"params",void 0)}change(){return this.current}created(){var O=this,f=this.list.filter(function(u){return u.required});this.paramsNameList=f.map(function(u){return{name:"".concat(u.name,"(").concat(u.description,")"),uid:u.name}}),f.forEach(function(u){O.paramsValueList[u.name]=u.shortlist}),this.current=this.params}handleFieldValueChange(){var O=this;this.field&&(this.current.find(function(f){return f.id===O.field}).value=this.fieldValue)}handleFieldChange(){var O=this;this.field&&(this.fieldValue=this.current.find(function(f){return f.id===O.field}).value)}render(){var O=this,f,u;return(0,n.createVNode)("div",{class:"full-width full-height params-select"},[(0,n.createVNode)("div",{class:"flex-row full-width"},[(0,n.createVNode)(v.Select,{placeholder:"\u8BF7\u9009\u62E9\u53C2\u6570",modelValue:O.field,"onUpdate:modelValue":function(j){return O.field=j},clearable:!1,class:"flex-1",onChange:this.handleFieldChange},g(u=this.paramsNameList.map(function(m){return(0,n.createVNode)(N,{value:m.uid,key:m.uid,label:m.name},null)}))?u:{default:function(){return[u]}}),(0,n.createVNode)(v.Select,{placeholder:"\u8BF7\u9009\u62E9\u53C2\u6570\u503C",modelValue:O.fieldValue,"onUpdate:modelValue":function(j){return O.fieldValue=j},class:"flex-1",onChange:this.handleFieldValueChange},{default:function(){return[(f=O.paramsValueList[O.field])===null||f===void 0?void 0:f.map(function(j){return(0,n.createVNode)(N,{value:j,key:j,label:j},null)})]}})])])}};(0,c.__decorate)([(0,s.Prop)({type:Array,default:function(){return[]}})],S.prototype,"list",void 0),(0,c.__decorate)([(0,s.VModel)({default:[]})],S.prototype,"params",void 0),(0,c.__decorate)([(0,s.Emit)("change")],S.prototype,"change",null),S=(0,c.__decorate)([s.Component],S);var M=S;o.default=M},56350:function(Q,o,t){"use strict";t(81821),t(34),t(84873),t(1714);var p=t(38600);Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0,t(6125),t(20148),t(50754),t(35340),t(14775),t(37209),t(2968),t(19903),t(3105),t(17777),t(58146);var n=p(t(64375)),C=p(t(65809)),c=p(t(63638)),s=t(35385),v=t(64210),g=t(70748),N=t(12692),S=p(t(63595)),M=t(92244),L=t(71633),O=t(29113),f=t(11016),u=t(39456),m=t(81133),j=p(t(55760)),F=t(22247),w=p(t(32869)),P=t(36473),I=p(t(71997));function U(_,y){var l=Object.keys(_);if(Object.getOwnPropertySymbols){var e=Object.getOwnPropertySymbols(_);y&&(e=e.filter(function(a){return Object.getOwnPropertyDescriptor(_,a).enumerable})),l.push.apply(l,e)}return l}function k(_){for(var y=1;y<arguments.length;y++){var l=arguments[y]!=null?arguments[y]:{};y%2?U(Object(l),!0).forEach(function(e){(0,c.default)(_,e,l[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(_,Object.getOwnPropertyDescriptors(l)):U(Object(l)).forEach(function(e){Object.defineProperty(_,e,Object.getOwnPropertyDescriptor(l,e))})}return _}var H=(0,I.default)(),z=class extends(0,v.TSX)()(v.Vue){constructor(){super(...arguments),(0,c.default)(this,"panelModel",void 0),(0,c.default)(this,"expendList",[!0,!0]),(0,c.default)(this,"loading",!0),(0,c.default)(this,"loadingColumns",!0),(0,c.default)(this,"error",{type:"empty",msg:""}),(0,c.default)(this,"tableList",[]),(0,c.default)(this,"tableColumns",{}),(0,c.default)(this,"storage",{}),(0,c.default)(this,"formData",[]),(0,c.default)(this,"envs",[{id:"preview",name:"\u9884\u89C8\u73AF\u5883"},{id:"stag",name:"\u9884\u53D1\u5E03\u73AF\u5883"},{id:"prod",name:"\u751F\u4EA7\u73AF\u5883"}])}changePanelChartType(y){y==="time-series-mixed"?this.panelModel.query.length<2&&this.addQuery():this.panelModel.query.length>1&&this.formData.splice(1,1)}get chartMeta(){var y=this;return m.ChartSourceModule.chartSourceList.find(function(l){return l.id===y.panelModel.type})}created(){this.init()}init(){this.initData()}initData(){var y=this;return(0,C.default)(regeneratorRuntime.mark(function l(){return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:y.getTables(y.panelModel.datasource.uid).then(function(){var r;if(y.formData=[],y.expendList=[],y.formData=y.panelModel.query,y.panelModel.datasource&&(r=y.panelModel.query)!==null&&r!==void 0&&r.length&&H.panel.datasource.uid===y.panelModel.datasource.uid){for(var i=0;i<y.panelModel.query.length;i++)if(y.panelModel.query[i]){var d=y.panelModel.query[i].table;y.panelModel.query[i].ref_id||(y.panelModel.query[i].ref_id=L.Letters[i]),d&&(y.panelModel.datasource.type==="bkbase"&&y.getStorage(d,i),y.getColumnsData(d)),y.expendList.push(!0)}}else y.addQuery();y.panelModel.type==="time-series-mixed"&&y.panelModel.query.length<2&&(y.addQuery(),y.expendList=[!0,!0])}).finally(function(){y.loading=!1});case 1:case"end":return a.stop()}},l)}))()}addFormData(y){var l=P.DataSourceModule.datasourceMap.get(this.panelModel.datasource.type),e=l?.QueryConfig||N.QueryMysqlSimpleClass;return console.log(new e(y)),new e(y)}addQuery(){var y=this,l=L.Letters[this.formData.length],e=window.location.search.substr(1),a=S.default.parse(e),r=a.datasouce_table,i=this.addFormData(l);r&&(i.table=String(r),(0,g.nextTick)(function(){y.getColumns(0,i.table)})),this.formData.push(i),this.expendList.splice(this.formData.length,0,!0)}copyQuery(y,l){y.stopPropagation();var e=(0,O.deepClone)(l);e.ref_id=String.fromCharCode(97+this.formData.length).toUpperCase(),this.formData.push(e),this.expendList.splice(this.formData.length,0,!0)}deleteQuery(y,l){var e=this;y.stopPropagation(),console.log(l),(0,w.default)("\u63D0\u793A","\u786E\u8BA4\u8981\u5220\u9664",function(){e.formData.splice(l,1),e.expendList.splice(l,1);for(var a=0;a<e.formData.length;a++)e.formData[a].ref_id=String.fromCharCode(97+a).toUpperCase()})}getTables(y){var l=this;return this.error.msg="",this.loading=!0,(0,M.getTablesList)(y).then(function(e){l.tableList=e.map(function(a){return{value:a,label:a}})}).catch(function(e){l.error.msg=e?.message||"\u8BF7\u6C42\u51FA\u9519",l.error.type="500"})}getColumns(y,l){var e;!l||(((e=this.panelModel.datasource)===null||e===void 0?void 0:e.type)==="bkbase"&&this.getStorage(l,y),this.getColumnsData(l))}getColumnsData(y){var l=this;this.tableColumns[y]||(this.loadingColumns=!0,this.tableColumns[y]=[],(0,M.getTableColumns)(this.panelModel.datasource.uid,y).then(function(e){l.tableColumns[y]=e}).catch(function(e){l.tableColumns[y]=null,(0,F.Message)({theme:"error",message:e?.message||"\u52A0\u8F7D\u5B57\u6BB5\u5931\u8D25"})}).finally(function(){l.loadingColumns=!1}))}getStorage(y,l){var e=this;Object.prototype.hasOwnProperty.call(this.storage,y)||(0,M.getBkBaseStorage)(y).then(function(a){e.storage[y]=a.map(function(i){return{id:i,name:i}});var r=(0,n.default)(a,1);e.formData[l].storage=r[0]})}changeSqlModel(y,l){if(l){var e;y.raw_query=l;var a;if(y.time_filter.field&&y.time_filter.type==="datetime"){var r=this.formData[0].time_filter;a=r.category==="fixed"?[r.range.from,r.range.to]:u.QueryContextModule.timeRange}else a=u.QueryContextModule.timeRange;var i=(0,f.getTimeRange)(a),d=(0,n.default)(i,2),b=d[0],V=d[1],T=u.QueryContextModule.variables;(0,M.renderSql)({query:k(k({},y),{},{datasource:{type:this.panelModel.datasource.type,uid:this.panelModel.datasource.uid},format:((e=this.chartMeta)===null||e===void 0?void 0:e.data_type)||y.format}),option:{range:{from:b,to:V,raw:{from:a[0],to:a[1]},datetime_str:{from:(0,j.default)(b).format("YYYY-MM-DD HH:mm:ss"),to:(0,j.default)(V).format("YYYY-MM-DD HH:mm:ss")}},variables:T}}).then(function(h){y.query_text=h}).catch(function(h){(0,F.Message)({theme:"error",message:h?.message||"\u6E32\u67D3sql\u51FA\u9519"}),y.query_text="select * from xxx"})}else(0,w.default)("\u5207\u6362\u7B80\u6613\u6A21\u5F0F","\u5207\u6362\u56DE\u7B80\u6613\u6A21\u5F0F\u5C06\u6E05\u9664\u60A8\u6240\u505A\u7684\u4EFB\u4F55\u6539\u52A8\uFF0C\u662F\u5426\u7EE7\u7EED\uFF1F",function(){y.raw_query=l})}};(0,s.__decorate)([(0,v.Prop)()],z.prototype,"panelModel",void 0),(0,s.__decorate)([(0,v.Watch)("panelModel.type")],z.prototype,"changePanelChartType",null),z=(0,s.__decorate)([v.ComponentBase],z);var R=z;o.default=R},5642:function(Q,o,t){"use strict";var p=t(38600);Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0,t(34),t(37209),t(14775),t(58146);var n=t(70748),C=p(t(64375)),c=t(22247),s=t(95939);t(31775);var v=t(11016),g=p(t(55760));function N(f){return typeof f=="function"||Object.prototype.toString.call(f)==="[object Object]"&&!(0,n.isVNode)(f)}var S=c.Form.FormItem,M=c.Select.Option,L="YYYY-MM-DD HH:mm:ss",O=(0,n.defineComponent)({name:"QueryTime",props:{modelValue:{type:Object,default:[]},list:{type:Array,default:[]},handleTimeRangeChange:{type:Function},getTimeRangeFromFilter:{type:Function}},emits:["change","update:modelValue"],setup(f,u){var m=u.emit,j=(0,n.computed)({get:function(){return f.modelValue},set:function(z){return m("update:modelValue",z)}}),F=(0,n.computed)({get:function(){var z=j.value.range,R=z.from,_=z.to;return[R,_].join("--")},set:function(z){var R=z.split("--"),_=(0,C.default)(R,2),y=_[0],l=_[1];j.value.range={from:y,to:l}}}),w=(0,n.shallowRef)([(0,g.default)().startOf("d").toDate(),new Date]),P=(0,n.computed)(function(){return f.list.filter(function(H){return!!s.TIME_TYPE.find(function(z){var R;return z.toLowerCase()===((R=H.type)===null||R===void 0?void 0:R.toLowerCase())})})});function I(H){switch(H){case"fixed":{w.value=[(0,g.default)().startOf("d").toDate(),new Date];var z=(0,C.default)(w.value,2),R=z[0],_=z[1];j.value.range={from:(0,g.default)(R).format(L),to:(0,g.default)(_).format(L)}}break;case"dynamic_fixed":j.value.range={from:"now/d",to:"now/d"};break;default:j.value.range={from:"now/d",to:"now/d"};break}}function U(H){var z=(0,C.default)(H,2),R=z[0],_=z[1];j.value.range={from:(0,g.default)(R).format(L),to:(0,g.default)(_).format(L)}}function k(H){H||(j.value.field="");var z=P.value.find(function(R){return R.name===H});j.value.type=z.type}return{formData:j,options:P,timeRangeStr:F,timeRangeDate:w,changeCategory:I,changeDate:U,changeColumn:k}},render(){var f,u,m=this,j=function(){var w;switch(m.formData.category){case"fixed":return(0,n.createVNode)(c.DatePicker,{onChange:m.changeDate,modelValue:m.timeRangeDate,"onUpdate:modelValue":function(I){return m.timeRangeDate=I},class:"full-width",format:"yyyy-MM-dd HH:mm:ss",type:"daterange",placeholder:"\u9009\u62E9\u65E5\u671F\u8303\u56F4",clearable:!1},null);case"dynamic_fixed":return(0,n.createVNode)(c.Select,{class:"full-width",modelValue:m.timeRangeStr,"onUpdate:modelValue":function(I){return m.timeRangeStr=I},clearable:!1},N(w=v.SHORTCUTS.map(function(P,I){return(0,n.createVNode)(M,{label:P.text,value:P.short.join("--"),key:I},null)}))?w:{default:function(){return[w]}});default:return""}};return(0,n.createVNode)(S,{label:"\u65F6\u95F4"},{default:function(){return[(0,n.createVNode)("div",{class:"flex-row  align-items-center"},[(0,n.createVNode)("div",{class:"bv-query-time-select  flex-row align-items-center"},[(0,n.createVNode)("div",{class:"target-select-set"},[(0,n.createTextVNode)("\u65F6\u95F4\u5B57\u6BB5")]),(0,n.createVNode)(c.Select,{placeholder:m.$t("\u8BF7\u9009\u62E9\u65F6\u95F4\u5B57\u6BB5"),modelValue:m.formData.field,"onUpdate:modelValue":function(P){return m.formData.field=P},onChange:m.changeColumn,filterable:!0,allowCreate:!0,popoverMinWidth:268,class:"flex-1"},N(f=m.options.map(function(w){return(0,n.createVNode)(M,{label:w.name,key:w.name,value:w.name},{default:function(){return[(0,n.createVNode)("div",{class:"flex-row align-items-center justify-content-between"},[(0,n.createVNode)("div",{class:"flex-1 text-ov mr-normal"},[w.name]),(0,n.createVNode)("div",{style:{fontSize:".8em"}},[w.type])])]}})}))?f:{default:function(){return[f]}})]),m.formData.field?(0,n.createVNode)("div",{class:"bv-query-time-select flex-row align-items-center"},[(0,n.createVNode)("div",{class:"target-select-set"},[(0,n.createTextVNode)("\u805A\u5408\u89C4\u5219")]),(0,n.createVNode)(c.Select,{modelValue:m.formData.aggregate,"onUpdate:modelValue":function(P){return m.formData.aggregate=P},filterable:!0,clearable:!1,class:"flex-1"},N(u=s.TimeAggregateList.map(function(w){return(0,n.createVNode)(M,{key:w.id,value:w.id,label:w.name},null)}))?u:{default:function(){return[u]}})]):""]),m.formData.field?(0,n.createVNode)("div",{class:"flex-row  align-items-center mt-normal"},[(0,n.createVNode)("div",{class:"bv-query-time-select flex-row align-items-center"},[(0,n.createVNode)("div",{class:"target-select-set"},[(0,n.createTextVNode)("\u65F6\u95F4\u8303\u56F4")]),(0,n.createVNode)(c.Select,{modelValue:m.formData.category,"onUpdate:modelValue":function(P){return m.formData.category=P},onChange:m.changeCategory,filterable:!0,clearable:!1,class:"flex-1"},{default:function(){return[(0,n.createVNode)(M,{value:"dynamic",label:"\u8DDF\u968F\u5168\u5C40\u65F6\u95F4\u9009\u62E9\u5668"},null),(0,n.createVNode)(M,{value:"fixed",label:"\u56FA\u5B9A\u65F6\u95F4\u8303\u56F4"},null),(0,n.createVNode)(M,{value:"dynamic_fixed",label:"\u52A8\u6001\u8303\u56F4"},null),(0,n.createVNode)(M,{value:"no limit",label:"\u4E0D\u9650\u5236\u8303\u56F4"},null)]}})]),(0,n.createVNode)("div",{class:"flex-row align-items-center",style:"width:318px;"},[j()])]):""]}})}});o.default=O}}]);
